---
title:“使用本機 SDK 進行取證水印”
description:“在本主題中，您將學習如何使用 Brightcove Native SDK 交付受取證水印保護的視頻。”
parent: Features 
grandparent: Home
---
 <h1>{{ page.title }}</h1>
<article class="bcls-article">
  <summary>{{ page.description }}</summary>

  <section class="bcls-section">
    <h2 id="Introduction">介紹</h2>
    <p>
      使用 Forensic Watermarking，您可以保護您的優質內容免遭盜版和未經授權的內容共享。此功能為您的視頻添加了隱形水印，讓您可以跟踪任何內容洩漏。
    </p>
    <p>有關更多信息，請參閱<a href="https://apis.support.brightcove.com/general/overview-forensic-watermarking.html">概述：法醫水印</a>文檔。</p>
  </section>

  <section class="bcls-section">
    <h2 id="Requirements">要求</h2>
    <p>支持此功能需要滿足以下要求：</p>
    <h3>設置</h3>
    <p>除了配置播放器外，還有一些設置要求。有關詳細信息，請參見<a href="https://apis.support.brightcove.com/general/overview-forensic-watermarking.html">概述：法醫水印</a>文檔。</p>

    <h3>設備操作系統版本</h3>
    <ul>
      <li>Android 6.0及更高版本</li>
      <li>iOS 11.0及更高版本</li>
    </ul>

    <h3>Brightcove SDK版本</h3>
    <ul>
      <li>適用於 Android 6.16.3 及更高版本的原生 SDK</li>
      <li>適用於 iOS 6.9.0 及更新版本的原生 SDK</li>
    </ul>
  </section>

  <section class="bcls-section">
    <h2 id="Using_Playback_Rights_Android">Android實施</h2>
    <p>取證水印的配置在視頻級別執行。</p>
    
    <ol class="bcls-tasklist-restart">
      <li>
        <p>播放器必須與您的註冊系統集成，以便在分析網絡信標上傳遞查看者 ID（在<code translate="No">user</code>場地）。</p>
        <p>例如：</p>
  <pre class="line-numbers"><code class="language-java" translate="No">HashMap&lt;String, String&gt; baseParams = new HashMap&lt;&gt;();
  baseParams.put(Analytics.Fields.USER, &quot;viewer id&quot;);
  baseParams.put(Analytics.Fields.APPLICATION_ID, &quot;application id&quot;);
  
  HashMap&lt;String, Object&gt; eventParams = new HashMap&lt;&gt;();
  eventParams.put(Analytics.Fields.BASE_PARAMS, baseParams);
  eventEmitter.emit(EventType.ADD_ANALYTICS_BASE_PARAMS, eventParams);          
</code></pre>
      </li>
      <li>
        <p>在裡面<code translate="No">Catalog.findVideo</code>或者<code translate="No">Catalog.findPlaylist</code>方法調用，添加<code translate="No">VideoUtil</code>添加水印令牌的方法。</p>

        <p><strong>在 onVideo 回調中</strong></p>
        <pre><code class="language-java" translate="No">public void onVideo(Video video) {
    VideoUtil.addWatermarkingToken(video, yourWatermarkingToken);
    brightcoveVideoView.add(video);
} 
</code></pre>
        <p><strong>在 onPlaylist 回調中</strong></p>
        <pre><code class="language-java" translate="No">public void onPlaylist(Playlist playlist) {
  for (Video video : testPlaylist.getVideos()) {
      VideoUtil.addWatermarkingToken(video, yourWatermarkingToken);
  }
  brightcoveVideoView.addAll(testPlaylist.getVideos());
}
</code></pre>
      </li>
      <!-- <li>
        <p>
          <p>In the player Activity’s <code translate="No">onCreate</code> method, add this call, before any Catalog calls to retrieve your video or playlist:</p>
          <pre><code class="language-java" translate="No">VideoUtil.setWatermarkingToken(yourWatermarkingToken);
</code></pre>
        </p>
      </li> -->
      <li>
        <p>有了這個調用，當目錄從播放 API 檢索視頻或播放列表元數據時，<code translate="No">VideoUtil</code>類將替換水印標記佔位符<code translate="No">{WMT}</code>使用令牌值，無論它出現在視頻的源 URL 中的任何位置。可以為可能帶有水印的播放列表中的每個視頻替換此標記。</p>
      </li>
    </ol>

    <h3>Chromecast</h3>
    <p>要投射帶水印的視頻，您需要在構建您的應用程序時提供您的應用程序 ID、水印令牌和用戶 ID <code translate="No">BrightcoveCastCustomData</code>帶有 Cast 插件的對象。</p>
      <p>在您的代碼中設置<code translate="No">BrightcoveCastCustomData</code>對象，添加這一行：</p>
      <pre><code class="language-java" translate="No">public static void setupGoogleCast() {
GoogleCastComponent.Builder castPluginBuilder = new GoogleCastComponent.Builder(eventEmitter, context)
        .setAutoPlay(isAutoPlayEnabled)
        .setQueuingSupported(isQueuingSupported);

    BrightcoveCastCustomData.Builder customDataBuilder = new BrightcoveCastCustomData.Builder(context)
        .setApplicationId(yourApplicationId)
        .setWatermarkingToken(yourWatermarkingToken);
        .setUserId(yourUserId);
        // Add the custom data elements to the castPluginBuilder
        
    castPluginBuilder
        .setEnableCustomData(true)
        .setCustomData(customDataBuilder.build());
}            
</code></pre>

    <p>當您打開帶有水印視頻的投射連接時，您應該看到<code translate="No">customData</code>對象格式如下：</p>
    <pre><code class="language-json" translate="No">{
      &quot;accountId&quot;: &quot;yourAccountId&quot;,
      &quot;analyticsParams&quot;: {
          &quot;application&quot;: &quot;yourApplicationId&quot;,
          &quot;user&quot;: &quot;yourUserId&quot;
      },
      &quot;catalogParams&quot;: {
          &quot;type&quot;: &quot;video&quot;,
          &quot;id&quot;: &quot;videoId&quot;,
          &quot;policyKey&quot;: &quot;yourPolicyKey&quot;,
          &quot;watermarkingToken&quot;: &quot;yourWatermarkingToken&quot;
      }
  }  
</code></pre>

    <h3>離線播放</h3>
    <p>下載視頻的過程可能涉及多個 Catalog 調用以檢索當前視頻元數據。Brightcove 建議添加<code translate="No">onVideo</code>上面的回調代碼可能會出現在獲取購買或租賃許可以及下載視頻時的回調中。
    </p>
    <p>下載視頻後，離線播放應照常進行。</p>
    <p>
      有關詳細信息，請參見<a href="https://github.com/BrightcoveOS/android-player-samples/blob/master/brightcove-exoplayer/OfflinePlaybackSampleApp/src/main/java/com/brightcove/player/samples/offlineplayback/MainActivity.java">離線播放示例應用</a>。
    </p>

  </section>

  <section class="bcls-section">
    <h2 id="iOS_Implementation">iOS實施</h2>
    <p>
      要將播放器配置為使用取證水印，請執行以下步驟：
    </p>
    <ol class="bcls-tasklist-restart">
      <li>
        <p>播放器必須與您的註冊系統集成，以便在分析網絡信標上傳遞查看者 ID（在<code translate="No">user</code>場地）。</p>
        <p>在這裡，您將提供用戶 ID 和應用程序 ID 的值：</p>
        <pre class="line-numbers"><code class="language-objectivec" translate="No">@try
  {
    [BCOVGlobalConfiguration.sharedConfig setValue:@{
      @&quot;privateUser&quot;: @&quot;your user id&quot;,
      @&quot;privateApplication&quot;: @&quot;your application id&quot;
    }
    forKey:@&quot;privateSessionAnalytics&quot;];
  }
  @catch (NSException *e)
  {
    NSLog(@&quot;%@&quot;, e.description);
  }       
</code></pre>
      </li>
      <li>
        <p>作為單個視頻或播放列表的 Brightcove 目錄請求的一部分，您將提供您的 NAGRA 水印令牌。這是使用<code translate="No">watermarkingToken</code>財產。</p>
        <p>將您的水印令牌添加到播放服務。</p>
        <pre class="line-numbers"><code class="language-objectivec" translate="No">/**
* The watermarking token for use with Forensic Watermarking
*/
@property (nonatomic, copy) NSString *watermarkingToken;
...
playbackService.watermarkingToken = self.watermarkingToken;     
</code></pre>
      </li>
      <li>
        <p>向 Brightcove 目錄提出單個視頻或播放列表的請求。</p>
        <p>對於視頻請求：</p>
<pre class="line-numbers"><code class="language-objectivec" translate="No">- (void)findVideoWithVideoID:(NSString *)videoID parameters:
  (NSDictionary *)parameters completion:(void (^)
  (BCOVVideo *video, NSDictionary *jsonResponse, NSError *error))completionHandler;
</code></pre>
        <p>對於播放列表請求：</p>
<pre class="line-numbers"><code class="language-objectivec" translate="No">- (void)findPlaylistWithPlaylistID:(NSString *)playlistID parameters:
  (NSDictionary *)parameters completion:(void (^)
  (BCOVPlaylist *playlist, NSDictionary *jsonResponse, NSError *error))completionHandler;
</code></pre>   
      </li>
    </ol>
    <p>有關詳細信息，請參閱 iOS 參考的 Native SDK 的 Forensic Watermarking 部分。</p>

    <h3>Chromecast</h3>
    <p>對於投射，您需要提供水印標記和 userId 字段。</p>
      <p>在您的代碼中設置<code translate="No">BrightcoveCastCustomData</code>對象，添加這一行：</p>
      <pre><code class="language-objectivec" translate="No">BCOVReceiverAppConfig *appConfig = [BCOVReceiverAppConfig new];
...
appConfig.userId = @&quot;ios-client@brightcove.com&quot;;
appConfig.watermarkingToken = watermarkingToken;
...                 
</code></pre>

    <p>在調試控制台中，您可以看到將用於 Chromecast 會話的配置值。</p>
    <pre><code class="language-json" translate="No">Google Cast Custom Data: {
  accountId = &lt;your_account_id&gt;;
  analyticsParams =     {
      application = &quot;&quot;;
      user = &quot;ios-client@brightcove.com&quot;;
  };
  catalogParams =     {
      adConfigId = &quot;&quot;;
      bcovAuthToken = &quot;&quot;;
      id = &lt;your_video_id&gt;;
      policyKey = &quot;&lt;your_policy_key&quot;;
      type = video;
      watermarkingToken = &quot;&lt;your_watermark_token&quot;;
  };    
</code></pre>

    <h3>離線播放</h3>
    <p>下載視頻後，離線播放應照常工作。</p>

    <p>
      要開始使用此功能，請參閱<a href="https://github.com/brightcove/brightcove-player-sdk-ios/blob/master/OfflinePlayback.md">iOS App 開發者離線播放指南</a>參考。
    </p>
  </section> 

  <section class="bcls-section">
    <h2 id="Limitations">局限性</h2>
    <p>有關此功能限制的詳細信息，請參閱<a href="https://apis.support.brightcove.com/general/overview-forensic-watermarking.html#Limitations">概述：法醫水印</a>文檔。</p>
  </section>

</article>