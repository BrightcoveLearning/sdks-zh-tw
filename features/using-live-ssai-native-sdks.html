---
title: '將 Live SSAI 與本機 SDK 結合使用' 
description:在本主題中，您將學習如何使用 Brightcove Native SDK 播放為服務器端廣告插入 (SSAI) 啟用的直播流。
parent: Live 
grandparent: Android Development
---
 <h1>{{ page.title }}</h1>
<article class="bcls-article">
  <summary>{{ page.description }}</summary>

<section class="bcls-section">
<h2 id="Overview">概述</h2>

<p>服務器端廣告插入（<span translate="No"> SSAI</span> ) 允許您將廣告拼接到您的視頻內容流中，以提供類似電視的觀看體驗。要使用本機 SDK 播放實時流，您需要在視頻請求中傳遞播放令牌。</p>

<p>居住<span translate="No">SSAI</span>允許您：</p>

<ul>
	<li>使用從編碼器發送的提示點插入廣告或使用<span translate="No">實時 API</span></li>
	<li>提取“板岩"資產以填充所有未使用的廣告時間</li>
	<li>避免將廣告屏蔽在服務器端的實時流中，以阻止廣告攔截</li>
</ul>
</section>

<section class="bcls-section">
<h2 id="Steps">腳步</h2>

<p>播放直播<span translate="No">SSAI</span>， 按著這些次序：</p>

<ol class="bcls-tasklist-restart">
	<li><a href="https://studio.support.brightcove.com/admin/configuring-server-side-ad-settings.html#Creating_a_Live_ad_configuration">創建實時廣告配置</a>使用Video Cloud Studio</li>
	<li>可選的：<a href="https://live.support.brightcove.com/live-module/implementing-server-side-ads-live-module.html#fill_slate">創建板岩資產</a>和/或<a href="https://live.support.brightcove.com/live-api/ssai/live-api-cue-points-and-ad-beacons-ssai.html">插入提示點和廣告信標</a></li>
	<li><a href="#Create_a_live_event">創建現場活動</a></li>
	<li><a href="#Get_the_playback_token">獲取播放令牌</a></li>
	<li>
	<p>構建您的應用程序：</p>

	<ul>
		<li><a href="#Android_implementation">Android實施</a></li>
		<li><a href="#iOS_implementation">iOS實施</a></li>
		<!-- <li><a href="#tvOS_implementation">tvOS implementation</a></li> -->
	</ul>
	</li>
	<li><a href="https://live.support.brightcove.com/live-module/implementing-server-side-ads-live-module.html#Requesting_an_ad">要求廣告休息</a></li>
</ol>

<aside class="bcls-aside bcls-aside--tip">如果您願意，可以使用 Live API 創建流並配置廣告插播時間。有關詳細信息，請參見<a href="https://live.support.brightcove.com/live-api/ssai/live-api-server-side-ad-insertion-ssai.html">實時API：服務器端廣告插入 (SSAI)</a>文檔。</aside>
</section>

<section class="bcls-section">
<h2 id="Create_a_live_event">創建現場活動</h2>

<p>默認情況下，您的實時流將使用Brightcove CDN。如果願意，可以使用自己選擇的CDN（BYO CDN或“自帶帶寬"）。要使用您自己的 CDN，請在本節和<a href="#Get_the_playback_token">獲取播放令牌</a>部分。</p>

<p>要創建實時事件，請按以下步驟操作：</p>

<ol class="bcls-tasklist-restart">
	<li>請參閱<a href="https://live.support.brightcove.com/live-module/implementing-server-side-ads-live-module.html#create_event">在實時模塊中實施服務器端廣告</a>文檔。</li>
  <li>展開<strong>高級選項</strong>部分。</li>
	<li>
    <p>選擇<strong>啟用服務器端廣告插入 (SSAI)</strong>，並選擇一個<strong>填充石板</strong> .</p>
    <figure class="bcls-figure"><img class="bcls-image--no-border" alt="Enable SSAI" src="/assets/images/features/live-ssai/enable-ssai.png" />
      <figcaption class="bcls-caption--image">啟用SSAI</figcaption>
      </figure>
  </li>
	<li>
	<p><strong>可選的</strong>：要使用您自己的 CDN，請包括以下附加步驟：</p>
	<ul>
		<li>
		<p>在裡面<strong>高級選項</strong>部分，選擇<strong>添加多 CDN 配置</strong>選項。</p>

		<figure class="bcls-figure"><img class="bcls-image--no-border" alt="Multi CDN Configuration" src="/assets/images/features/live-ssai/add-cdn.png" />
		<figcaption class="bcls-caption--image">多CDN配置</figcaption>
		</figure>
		</li>
		<li>
      <p>輸入您自己的CDN的標籤和URL。有關詳細信息，請參閱<a href="https://studio.support.brightcove.com/general/content-delivery-options.html">內容交付選項</a>文檔。</p>
      <figure class="bcls-figure"><img class="bcls-image--no-border" alt="Add label and URL" src="/assets/images/features/live-ssai/add-label-and-url.png" />
      <figcaption class="bcls-caption--image">添加標籤和網址</figcaption>
      </figure>
    </li>
	</ul>
	</li>
  <li>
    完成配置實時事件後，單擊<strong>創建事件</strong> .
  </li>
</ol>
</section>

<section class="bcls-section">
<h2 id="Get_the_playback_token">獲取播放令牌</h2>

<p>當您在直播中啟用 SSAI 時，播放器嵌入代碼將包含一個<code translate="No">adConfigId</code>範圍。此值是播放令牌，您將在應用中請求視頻內容時使用該令牌。</p>

<p>要獲取播放令牌，請按照下列步驟操作：</p>

<ol class="bcls-tasklist-restart">
	<li>在 Video Cloud Studio 中，返回到<strong>居住</strong>模塊。</li>
	<li>在左側導航中，選擇<strong>發布和嵌入</strong> .</li>
	<li>
    <p>在裡面<strong>實時播放器選項</strong>部分，展開<strong>選擇廣告配置</strong>選項，然後選擇您在上一步中創建的實時廣告配置。</p>
    <figure class="bcls-figure"><img class="bcls-image--no-border" alt="Select Ad Configuration" src="/assets/images/features/live-ssai/select-ad-config.png" />
    <figcaption class="bcls-caption--image">選擇廣告配置</figcaption>
    </figure>
	</li>
  <li>
    <p>複製<a href="">標準嵌入代碼</a>到剪貼板。</p>
    <figure class="bcls-figure"><img class="bcls-image--no-border" alt="Embed code" src="/assets/images/features/live-ssai/embed-code.png" />
    <figcaption class="bcls-caption--image">嵌入代碼</figcaption>
    </figure>
	</li>
	<li>
	  <p>從嵌入代碼中，複製<code translate="No">VideoId</code>參數值。您將在後面的步驟中使用此值。它看起來應該類似於：</p>
	<pre>
<code class="language-html" translate="No">1700044540369289748</code></pre>
	</li>
  <li>
	  <p>從嵌入代碼中，複製<code translate="No">adConfigId</code>參數值。您將在後面的步驟中使用此值。這<code translate="No">adConfigId</code> value 是從 Video Cloud 庫請求內容時傳遞的播放令牌。它看起來應該類似於：</p>
	<pre>
<code class="language-html" translate="No">live.t0vbpNIjTPW6IZ29QsyuWrmgjvQjEWe3u_wPmaMqnhAmE05DCF7aAa-6fDIkvryJctH1rADJnfXYANy7tDg4agQFx23WIvsXMmAjz1BiNl-S3rFZ9tRdzRWdo1E4FTLkET6XcNuNZ2acTnzmow</code></pre>
	</li>
	<li>您還需要帳戶 ID 和策略密鑰。</li>
</ol>
</section>

<section class="bcls-section">
<h2 id="Android_implementation">Android實施</h2>

<p>要播放實時流，您將包括<code translate="No">adConfigId</code>參數和視頻請求的播放令牌值。</p>

<p>請按照以下步驟構建您的應用程序：</p>

<ol class="bcls-tasklist-restart">
	<li>使用<a href="https://github.com/BrightcoveOS/android-player-samples/tree/master/brightcove-exoplayer/BasicSsaiSampleApp">基本 SSAI 示例應用程序</a>作為代碼的起點。</li>
	<li>在裡面<strong>res / values / strings.xml</strong>文件，將以下內容替換為您自己的值
	<ul>
		<li>帳戶ID</li>
    <li>政策金鑰</li>
		<li>視頻 ID（來自<a href="#Get_the_playback_token">獲取播放令牌</a>以上部分）</li>
	</ul>
	</li>
	<li>
	<p>在裡面<strong>主活動.java</strong>文件，替換<code translate="No">ad_config_id</code>值與您從 Live 模塊中復制的播放令牌（實時 URL）<a href="#Get_the_playback_token">獲取播放令牌</a>以上部分。</p>
	<pre>
<code class="language-java" translate="No">private final String AD_CONFIG_ID_QUERY_PARAM_VALUE = "live.t0vbpNIjTPW6IZ29QsyuWrmgjvQjEWe3u_wPmaMqnhAmE05DCF7aAa-6fDIkvryJctH1rADJnfXYANy7tDg4agQFx23WIvsXMmAjz1BiNl-S3rFZ9tRdzRWdo1E4FTLkET6XcNuNZ2acTnzmow";</code></pre>
	</li>
	<li>
	<p>這<code translate="No">ad_config_id</code>將您的播放令牌值作為查詢參數添加到 HTTP 請求中。</p>

	<pre class="line-numbers">
<code class="language-java" translate="No">HttpRequestConfig httpRequestConfig = new HttpRequestConfig.Builder()
  .addQueryParameter(AD_CONFIG_ID_QUERY_PARAM_KEY, AD_CONFIG_ID_QUERY_PARAM_VALUE)
  .build();
</code></pre>
	</li>
	<li>
	<p>使用您的實時流視頻ID和更新的HTTP請求對Playback API進行目錄調用。</p>

	<pre class="line-numbers">
<code class="language-java" translate="No">catalog.findVideoByID(getString(R.string.video_id), httpRequestConfig, new VideoListener() {
   @Override
   public void onVideo(Video video) {
       plugin.processVideo(video);
   }
 });
</code></pre>
	</li>
	<li>
	<p>您的應用已準備好播放直播。</p>

	<p>有關在Android Native SDK中使用為SSAI啟用的實時流的更多詳細信息，請參閱<a href="https://www.brightcove.com/en/blog/2019/12/ssai-plugin-changes-690">6.9.0中的SSAI插件更改</a>博客文章。</p>
	</li>
</ol>
</section>

<section class="bcls-section">
<h2 id="iOS_implementation">iOS實施</h2>

<p>要播放實時流，您將包括<code translate="No">adConfigId</code>參數和視頻請求的播放令牌值。</p>

<p>請按照以下步驟構建您的應用程序：</p>

<ol class="bcls-tasklist-restart">
	<li>使用<a href="https://github.com/BrightcoveOS/ios-player-samples/tree/master/SSAI/BasicSSAIPlayer">基本 SSAI 示例應用程序</a>作為代碼的起點。</li>
	<li>在裡面<strong>ViewController.swift</strong>文件，將以下內容替換為您自己的值
	<ul>
		<li>帳戶ID</li>
    <li>政策金鑰</li>
		<li>視頻 ID（來自<a href="#Get_the_playback_token">獲取播放令牌</a>以上部分）</li>
	</ul>
	</li>
	<li>
	<p>在裡面<strong>視圖控制器.swift</strong>文件，替換<code translate="No">AdConfigId</code>值與您從 Live 模塊中復制的播放令牌（實時 URL）<a href="#Get_the_playback_token">獲取播放令牌</a>以上部分。</p>

	<pre>
<code class="language-swift" translate="No">static let AdConfigId = "live.t0vbpNIjTPW6IZ29QsyuWrmgjvQjEWe3u_wPmaMqnhAmE05DCF7aAa-6fDIkvryJctH1rADJnfXYANy7tDg4agQFx23WIvsXMmAjz1BiNl-S3rFZ9tRdzRWdo1E4FTLkET6XcNuNZ2acTnzmow";</code></pre>
	</li>
	<li>
	<p>這<code translate="No">AdConfigId</code>將您的播放令牌值作為查詢參數添加到 HTTP 請求中。</p>

	<pre class="line-numbers">
<code class="language-swift" translate="No">let queryParameters = [kBCOVPlaybackServiceParamaterKeyAdConfigId: Constants.AdConfigId]
</code></pre>
	</li>
	<li>
	<p>使用您的實時流視頻ID和更新的HTTP請求對Playback API進行目錄調用。</p>

	<pre class="line-numbers">
<code class="language-swift" translate="No">playbackService.findVideo(withVideoID: Constants.VideoId, parameters: queryParameters) { [weak self] (video: BCOVVideo?, jsonResponse: [AnyHashable: Any]?, error: Error?) -&gt; Void in

   guard let _video = video else {
     print("ViewController Debug - Error retrieving video: \(error?.localizedDescription ?? "unknown error")")
     return
   }

   self?.playbackController?.setVideos([_video] as NSFastEnumeration)
}
</code></pre>
	</li>
	<li>您的應用已準備好播放直播。</li>
</ol>
</section>
</article>