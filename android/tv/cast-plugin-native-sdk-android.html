---
title: '適用於 Android 的 Native SDK 的 Cast 插件' 
description:在本主題中，您將學習如何使用適用於 Android 的 Brightcove Native SDK 的 Cast 插件將視頻投射到連接 Chromecast 的電視上。
parent: Connected TV 
grandparent: Android Development
layout: staging
---
 <h1>{{ page.title }}</h1>
<article class="bcls-article">
  <summary>{{ page.description }}</summary>

<section class="bcls-section">
<h2 id="Overview">概述</h2>

<p>和<a href="https://developers.google.com/cast/docs/developers">谷歌演員</a>技術，您可以啟動和控制從移動設備到高清電視和家庭音頻系統的流視頻內容。在您的應用中，點擊“投射"按鈕以在大屏幕上流式傳輸您的內容。</p>

<p>要構建 Cast 應用程序，您需要以下組件：</p>

<ul>
	<li>
	<p>一種<strong>發件人申請</strong> -它位於您的移動設備上，並檢測接收器設備，建立安全連接並鏡像您的內容。發送方應用是本地播放器，用於將內容投射到 Chromecast 設備上的接收方應用。投射到接收器應用後，您可以將其視為Chromecast的遙控器。</p>

	<p>發件人應用程序由適用於 Android 的 Brightcove Native SDK 的 Cast 插件提供。您將在本主題中了解它。</p>
	</li>
	<li>
	<p>一種<strong>接收者申請</strong> -此應用程序在Chromecast設備上運行。可以將其視為具有CSS和JavaScript資產的單頁HTML應用程序。</p>

	<p>對於測試，請按照下列步驟操作：</p>

	<ol class="bcls-tasklist">
		<li>從...開始<a href="https://github.com/googlecast/CastReceiver">Google 的示例 Cast Receiver</a></li>
		<li>審查<a href="https://developers.google.com/cast/docs/sample-apps#castreceiver">Google Cast 應用程序</a>文件</li>
	</ol>

	<p>對於生產用途，本文檔將說明如何使用Brightcove Receiver v2.0.0。</p>
	</li>
</ul>

<aside class="bcls-aside bcls-aside--information">
  <p>筆記：</p>
  <ol>
    <li>Google不支持在生產環境中使用其演示接收器應用程序。</li>
    <li>適用於 Android 的 Brightcove Native SDK 的 Cast 插件不提供接收器應用程序功能。</li>
  </ol>
  </aside>
</section>

<section class="bcls-section">
<h2 id="Supported_SDK_version">支持的SDK版本</h2>
<p>要將 Cast 插件與新的 Brightcove Receiver v2.0 一起使用，您必須使用適用於 Android 6.16.0 及更高版本的 Brightcove Native SDK。</p>
</section>

<section class="bcls-section">
<h2 id="Understanding_the_Cast_plugin">了解 Cast 插件</h2>
<p>Cast插件建立在<a href="https://medium.com/google-exoplayer/new-cast-extension-and-demo-app-55816a50012">新的 ExoPlayer Cast 擴展</a>和 Google Play 服務投射框架。添加演員轉換插件依賴關係後，gradle將拉取Play Services Cast Framework依賴關係，ExoPlayer Cast Extension依賴關係以及其他所需的依賴關係。</p>

<p>Cast 插件已經過重新設計，可最大限度地減少與 Video Cloud 集成時的工作量。使用視頻雲時，<code translate="No">BrightcoveCastMediaManager</code>類從 Video Cloud 響應中收集信息，例如 Brightcove <code translate="No">Video</code>和<code translate="No">Source</code>對象，每次<code translate="No">EventType.SET_SOURCE</code>事件發出。當用戶選擇播放以將視頻排隊時，此信息將被緩存並準備好使用。</p>
</section>

<section class="bcls-section">
<h2 id="Integrating_the_Cast_plugin">集成Cast插件</h2>
<p>有兩種方法可以將您的應用程序與適用於 Android Cast 插件的 Native SDK 集成。您可以與 Brightcove Cast Receiver v2.0 或 Google Cast Demo Receiver 集成。</p>
<p>對於任何一種集成，您都需要將此依賴項添加到您的應用程序項目中：</p>
<pre>
<code class="language-java" translate="No">implementation &quot;com.brightcove.player:android-cast-plugin:6.16.0&quot;</code></pre>

<h3 id="Using_the_Brightcove_Cast_Receiver_v2">使用 Brightcove Cast Receiver v2.0</h3>
<p>此集成適用於使用 Brightcove API 交付內容的 Brightcove 客戶。</p>
<p>有關完整的代碼示例，請參見<a href="https://github.com/BrightcoveOS/android-player-samples/tree/master/brightcove-exoplayer/BasicCastBrightcoveReceiverSampleApp">BasicCastBrightcoveReceiverSampleApp</a>。</p>

<h3 id="Using_the_Google_Cast_Demo_Receiver">使用 Google Cast 演示接收器</h3>
<p>此集成適用於剛接觸鑄造的 Brightcove 客戶。</p>
<p>有關完整的代碼示例，請參見<a href="https://github.com/BrightcoveOS/android-player-samples/tree/master/brightcove-exoplayer/BasicCastGoogleReceiverSampleApp">BasicCastGoogleReceiverSampleApp</a>。</p>
<aside class="bcls-aside bcls-aside--tip">這<strong>BasicCastGoogleReceiverSampleApp</strong>示例應用程序以前稱為<strong>BasicCastSampleApp</strong></aside>

<h4 id="Specifying_your_own_Cast_Receiver_App_Id">指定您自己的 Cast Receiver App ID</h4>
<p>這<strong>BasicCastGoogleReceiverSampleApp</strong>設置 Google Demo Receiver App ID，這有助於入門和測試，但不適用於生產。</p>
<p>要使用您的 Cast Receiver 應用程序覆蓋此值，請在示例應用程序的<strong>字符串.xml</strong>文件：</p>
<pre>
<code class="language-java" translate="No">&lt;string name=&quot;cast_receiver_app_id&quot;&gt;4F8B3483&lt;/string&gt;</code></pre>
</section>

<section class="bcls-section">
<h2 id="The_Brightcove_GoogleCastComponent">Brightcove GoogleCastComponent</h2>

<p>這<code translate="No">GoogleCastComponent</code> class 是 Brightcove Cast 插件的主類。它實例化ExoPlayer CastPlayer並設置其偵聽器。它提供了一些基本方法來加載視頻或將其添加到隊列中。這<code translate="No">GoogleCastComponent</code>類還添加了幾個 Brightcove 事件偵聽器來處理 Activity 和 Fragment 生命週期事件，以及可用於發出媒體信息以將視頻加載到 Chromecast 設備的其他事件偵聽器。</p>

<p>這<code translate="No">GoogleCastComponent</code>現在使用 Builder 模式。在v6.16.0之前的Android本機SDK版本中，您需要實例化該組件並傳遞<code translate="No">Context</code>和<code translate="No">EventEmitter</code>到<code translate="No">GoogleCastComponent</code>構造函數。然後，您將在一系列單獨的方法調用中設置組件的選項。</p>
<p>從 Native SDK for Android v6.16.0 開始，使用 Builder 模式創建<code translate="No">GoogleCastComponent</code>並設置它的選項，所有這些都在一個 Builder 方法調用鏈中。</p>
</section>

<section class="bcls-section">
<h2 id="CustomData">自訂資料</h2>
<p>與<code translate="No">GoogleCastComponent</code>， 這<code translate="No">CustomData</code>類使用Builder模式來實例化對象並向其添加屬性。雖然 Brightcove 接收器可以使用<code translate="No">CustomData</code>要從您的 Brightcove 目錄中檢索視頻，不需要發送完整的<code translate="No">CustomData</code>對象，例如用於投射遠程資產。還需要注意的是，在使用Google Demo Receiver時，<code translate="No">CustomData</code>不支持。為了便於討論，我們將重點關注<code translate="No">CustomData</code>發送到用於從Brightcove目錄中檢索視頻數據的接收器。</p>

<h3>什麼是自定義數據？</h3>
<p><code translate="No">CustomData</code>是JSON對象，包含在<code translate="No">MediaInfo</code>目的。它的預期用途是與Brightcove Cast Receiver App v2.0一起使用。</p>

<h3>帶Brightcove接收器的CustomData和目錄數據</h3>
<p>與 Brightcove 接收器集成時，<code translate="No">CustomData</code> JSON 對象將採用以下形式：</p>
<pre>
<code class="language-java" translate="No">&quot;customData&quot;: {
	&quot;accountId&quot;: &quot;1234567890&quot;,
	&quot;analyticsParams&quot;: {
		&quot;application&quot;: &quot;com.brightcove.player.test&quot;,
		&quot;user&quot;: &quot;abcde1c44b951234&quot;
	},
	&quot;catalogParams&quot;: {
		&quot;adConfigId&quot;: null,
		&quot;type&quot;: &quot;video&quot;,
		&quot;bcovAuthToken&quot;: null,
		&quot;id&quot;: &quot;2345678901&quot;,
		&quot;policyKey&quot;: &quot;BCpkPolicyKeyObject&quot;
	}
}
</code></pre>

<p>這<code translate="No">CustomData</code>上面的對象示例包含從 Brightcove 接收器投射視頻所需的所有數據元素。無論加密如何，此數據都是相同的，也就是說，在 DRM 視頻的情況下，許可證 URL 不需要額外的結構。</p>
<p>你還可以找到一個例子<code translate="No">CustomData</code>對像在<strong>BrightcoveCastBrightcoveReceiverSampleApp</strong> .</p>

<h3>Google演示接收器提供的CustomData</h3>
<p>如上所述，<code translate="No">CustomData</code>演示接收器不支持。</p>

</section>

<section class="bcls-section">
<h2 id="BrightcoveCastMediaManager">BrightcoveCastMediaManager</h2>

<p>可以擴展<code translate="No">BrightcoveCastMediaManager</code>，如上所示，以覆蓋其方法或實現您自己的方法。有關擴展BrightcoveCastMediaManager類的示例，請參見以下內容：</p>
<ul>
  <li>擴展BrightcoveCastMediaManager部分</li>
  <li>BasicCastCustomRemoteVideoSampleApp</li>
</ul>
</section>

<section class="bcls-section">
<h2 id="OptionsProvider">選項提供者</h2>

<p>接下來，您需要指定<a href="https://developers.google.com/android/reference/com/google/android/gms/cast/framework/OptionsProvider">選項提供者</a> Google Cast框架的實現。這<code translate="No">OptionsProvider</code>界面有助於設置初始化所需的幾個選項<a href="https://developers.google.com/android/reference/com/google/android/gms/cast/framework/CastContext">投射上下文</a>班級。您將在此處設置 Cast Receiver App ID。要了解有關集成的更多信息<code translate="No">OptionsProvider</code>，見谷歌<a href="https://developers.google.com/cast/docs/android_sender_integrate#initialize_the_cast_context">初始化 Cast 上下文</a>文檔。</p>
<p>Brightcove Cast 插件包括一個<code translate="No">DefaultOptionsProvider</code>類，其中 Cast Receiver App ID 是通過在<strong>字符串.xml</strong>資源文件。有關更多詳細信息，以及要了解如何在您的應用中覆蓋它，請參見<a href="#Using_your_own_Cast_Receiver_App_Id">使用您自己的演員表接收器應用程序ID</a>以上部分。</p>
<p>無論您使用<code translate="No">DefaultOptionsProvider</code>班級或你自己的<code translate="No">OptionsProvider</code>實現，你需要設置<code translate="No">OptionsProvider</code>應用程序中的實現類名稱<strong>AndroidManifest.xml</strong>文件作為鍵值對元數據，如下所示：</p>
<pre>
<code class="language-java" translate="No">&lt;meta-data android:name=&quot;com.google.android.gms.cast.framework.OPTIONS_PROVIDER_CLASS_NAME&quot; android:value=&quot;com.brightcove.cast.DefaultOptionsProvider&quot; /&gt;</code></pre>
<p>如果您使用<code translate="No">DefaultOptionsProvider</code>上課，您可以設置<code translate="No">ExpandedControllerActivity</code>通過在您的帳戶中設置類似的元數據信息來打開/關閉投射通知<strong>Android清單</strong>。</p>
</section>

<section class="bcls-section">
<h2 id="Expanded_Controller_Activity">擴展控制器活動</h2>

<p>這<a href="https://developers.google.com/android/reference/com/google/android/gms/cast/framework/media/widget/ExpandedControllerActivity">擴展控制器活動</a>附帶 Google Cast 庫，可讓您控制在 Chromecast 設備上投射的視頻。此類提供了一些自定義靈活性。例如，有五個插槽可用於顯示按鈕，其中第三個插槽是為不可配置的“播放"按鈕保留的。其餘按鈕可以設置為其他預定義按鈕或您自己的自定義按鈕。</p>

<p>Brightcove Cast 插件提供了子類<code translate="No">DefaultExpandedControllerActivity</code> .我們已按以下順序啟用以下按鈕：</p>

<ul>
	<li><strong>隱藏式字幕</strong></li>
	<li><strong>跳過上一個</strong></li>
	<li><strong>玩</strong></li>
	<li><strong>跳過下一步</strong></li>
	<li><strong>靜音切換</strong></li>
</ul>

<p>此外，搜索欄設置的默認可繪製對象與標準中使用的默認可繪製對象相同<code translate="No">BrightcoveMediaController</code>：</p>

<ul>
	<li>進度可繪製：
	<pre>
<code class="language-java" translate="No">R.drawable.default_scrubber_progress_horizontal</code></pre>
	</li>
	<li>拇指可繪製：
	<pre>
<code class="language-java" translate="No">R.drawable.default_scrubber_thumb</code></pre>
	</li>
</ul>

<p>要了解如何自定義搜索欄，請參閱<a href="https://github.com/BrightcoveOS/android-player-samples/tree/master/brightcove-player-controls/SeekBarColorsSampleApp/src/main">SeekBarColorsSampleApp</a> .</p>

<p>為了設置<code translate="No">DefaultExpandedControllerActivity</code>還是你自己的<code translate="No">ExpandedControllerActivity</code>，在您的<strong>AndroidManifest.xml</strong>文件：</p>
<pre class="line-numbers">
<code class="language-java" translate="No">&lt;meta-data  android:name="com.brightcove.cast.DefaultOptionsProvider.EXPANDED_CONTROLLER_ACTIVITY_CLASS_NAME"
android:value="com.brightcove.cast.DefaultExpandedControllerActivity" /&gt;</code></pre>
</section>

<section class="bcls-section">
<h2 id="Cast_Notification">演員表通知</h2>

<p>啟用投射通知後，當您投射視頻並將您的應用置於後台時會出現通知；例如，在按下主頁鍵後。</p>
&lt;p&gt;要啟用投射通知，請在您的<strong>AndroidManifest.xml</strong>文件，並提供單擊通知時要啟動的活動的名稱：</p>
<pre class="line-numbers">
<code class="language-java" translate="No">&lt;meta-data android:name="com.brightcove.cast.DefaultOptionsProvider.NOTIFICATION_TARGET_ACTIVITY_CLASS_NAME"
android:value="com.brightcove.cast.BrightcoveControllerActivity" /&gt;</code></pre>

<p>如果您不提供com.brightcove.cast.DefaultOptionsProvider.NOTIFICATION_TARGET_ACTIVITY_CLASS_NAME，或者該值具有無效的活動名稱，則投射通知將被關閉。</p>

<aside class="bcls-aside bcls-aside--information">去除的同時<code translate="No">meta-data</code>標籤來自<strong>AndroidManifest.xml</strong>文件將禁用來自發件人應用程序的通知，但仍然可以在發件人設備上查看通知，指示設備正在您的 Wi-Fi 網絡上投射。這不是來自發件人應用程序的通知，而是來自發件人設備的通知，與任何應用程序配置無關。</aside>
</section>

<section class="bcls-section">
<h2 id="The_Cast_Button">投射按鈕</h2>

<p>通過投射按鈕，您可以選擇與您的設備位於同一網絡中的 Chromecast 設備，並允許您連接和創建會話。要將投射按鈕添加到您的應用程序，請按照 Google 的<a href="https://developers.google.com/cast/docs/android_sender_integrate#add_a_cast_button">整合演員表：添加投射按鈕</a>文檔。</p>
<p>Brightcove Cast 插件提供了一種實用方法來輕鬆設置 Cast 按鈕。當您只想將 Cast 按鈕添加到 Activity/Fragment 菜單時，這很有用。詳情見以下代碼：</p>
	<pre class="line-numbers">
<code class="language-java" translate="No">//Activity
@Override
public boolean onCreateOptionsMenu(Menu menu) {
   super.onCreateOptionsMenu(menu);
   GoogleCastComponent.setUpMediaRouteButton(MainActivity.this, menu);
   return true;
}</code></pre>
</section>

<section class="bcls-section">
<h2 id="The_Mini_Controller">迷你控制器</h2>

<p>Mini Controller 是一個附加到您的 Activity 的 Fragment，通常位於佈局的底部。迷你控制器允許您播放和暫停視頻，並在您的 Chromecast 設備中播放視頻時發出指示。單擊迷你控制器時，將啟動擴展控制器。</p>
<p>要啟用迷你控制器，請將以下代碼添加到您的 Activity 佈局中。</p>
	<pre class="line-numbers">
<code class="language-java" translate="No">&lt;fragment
   android:id="@+id/castMiniController"
   android:layout_width="match_parent"
   android:layout_height="wrap_content"
   android:layout_alignParentBottom="true"
   android:visibility="gone"
   class="com.google.android.gms.cast.framework.media.widget.MiniControllerFragment" /&gt;</code></pre>

<p>要了解 Mini Controller 的最佳實踐，請參閱<a href="https://developers.google.com/cast/docs/design_checklist/sender#sender-mini-controller">設計清單：發送器迷你控制器</a>文檔。有關實現的詳細信息，請參見<a href="https://developers.google.com/cast/docs/android_sender_integrate#add_mini_controller">整合Cast：添加迷你控制器</a>文檔。</p>
</section>

<section class="bcls-section">
<h2 id="Advanced_Topics">進階主題</h2>

<h3 id="Listening_for_Cast_session">收聽演員表會議</h3>

<p>如果您希望您的應用在Cast連接開始或結束時做出反應，則可以添加<code translate="No">GoogleCastEventType.CAST_SESSION_STARTED</code>或者<code translate="No">GoogleCastEventType.CAST_SESSION_ENDED</code>事件偵聽器，如下所示：</p>

<pre class="line-numbers">
<code class="language-java" translate="No">eventEmitter.on(GoogleCastEventType.CAST_SESSION_STARTED, new EventListener() {
   @Override
   public void processEvent(Event event) {
       // Session Started
   }
});
eventEmitter.on(GoogleCastEventType.CAST_SESSION_ENDED, new EventListener() {
   @Override
   public void processEvent(Event event) {
       // Session Ended
   }
});</code></pre>

<p>或者，您可以致電<code translate="No">GoogleCastComponent.isSessionAvailable()</code>檢查可用的會話。</p>

<h3 id="Casting_a_Video">投放視頻</h3>

<p>為了在成功連接後將視頻投射到Chromecast，您可以使用EventEmitter並發出媒體信息信息，也可以直接使用<code translate="No">GoogleCastComponent</code>方法。</p>

<p>如果您希望發出媒體信息，則可以使用以下事件：</p>

<ul>
	<li><code translate="No">GoogleCastEventType.LOAD_MEDIA_INFO</code></li>
	<li><code translate="No">GoogleCastEventType.LOAD_MEDIA_QUEUE_ITEM</code></li>
	<li><code translate="No">GoogleCastEventType.ADD_MEDIA_INFO</code></li>
	<li><code translate="No">GoogleCastEventType.ADD_MEDIA_QUEUE_ITEM</code></li>
</ul>

<p>下表顯示了每個事件的預期屬性：</p>

<table class="bcls-table">
	<thead class="bcls-table__head">
		<tr>
			<th rowspan="2">活動名稱</th>
			<th colspan="2">特性</th>
		</tr>
		<tr>
			<th>鑰匙</th>
			<th>值類類型</th>
		</tr>
	</thead>
	<tbody class="bcls-table__body">
		<tr>
			<td><code translate="No">LOAD_MEDIA_INFO</code></td>
			<td><code translate="No">GoogleCastComponent.CAST_MEDIA_INFO</code><br />
			<code translate="No">GoogleCastComponent.CAST_MEDIA_PLAY_POSITION</code></td>
			<td><code translate="No">MediaInfo</code>整數</td>
		</tr>
		<tr>
			<td><code translate="No">LOAD_MEDIA_QUEUE_ITEM</code></td>
			<td><code translate="No">GoogleCastComponent.CAST_MEDIA_QUEUE_ITEM</code></td>
			<td><code translate="No">MediaQueueItem</code></td>
		</tr>
		<tr>
			<td><code translate="No">ADD_MEDIA_INFO</code></td>
			<td><code translate="No">GoogleCastComponent.CAST_MEDIA_INFO</code><br />
			<code translate="No">GoogleCastComponent.CAST_MEDIA_PLAY_POSITION</code></td>
			<td><code translate="No">MediaInfo</code>整數</td>
		</tr>
		<tr>
			<td><code translate="No">ADD_MEDIA_QUEUE_ITEM</code></td>
			<td><code translate="No">GoogleCastComponent.CAST_MEDIA_QUEUE_ITEM</code></td>
			<td><code translate="No">MediaQueueItem</code></td>
		</tr>
	</tbody>
</table>
<br/>
<p>或者，您可以使用以下內容<code translate="No">GoogleCastComponent</code>方法：</p>

<ul>
	<li>
	<pre>
<code class="language-java" translate="No">public void loadMediaInfo(MediaInfo mediaInfo, long positionMs)</code></pre>
	</li>
	<li>
	<pre>
<code class="language-java" translate="No">public void loadMediaInfo(MediaInfo mediaInfo)</code></pre>
	</li>
	<li>
	<pre>
<code class="language-java" translate="No">public PendingResult&lt;RemoteMediaClient.MediaChannelResult&gt; loadItem(MediaQueueItem mediaQueue, int playheadPosition)</code></pre>
	</li>
	<li>
	<pre>
<code class="language-java" translate="No">public PendingResult&lt;RemoteMediaClient.MediaChannelResult&gt; addItems(MediaQueueItem... mediaQueue )</code></pre>
	</li>
</ul>

<h3 id="Changing_the_default_MediaInfo_data">更改默認的MediaInfo數據</h3>

<p>默認情況下，Cast插件會收集有關由<code translate="No">EventType.SET_SOURCE event</code>。如果您想更改或添加其他信息，例如將自定義JSON對象添加到您的<code translate="No">MediaInfo</code>您的應用接收者可以理解的，您可以通過覆蓋<code translate="No">loadMediaInfo()</code>和<code translate="No">addMediaInfo()</code>來自的方法<code translate="No">BrightcoveCastMediaManager</code>。那麼，你的<code translate="No">BrightcoveCastMediaManager</code>子類作為構造函數參數傳遞給<code translate="No">GoogleCastComponent</code>班級。</p>

<p>在這些方法中，您可以創建自己的<code translate="No">MediaInfo</code>對象並發出相應的事件，如前所示。一定要檢查<code translate="No">com.brightcove.cast.util.CastMediaUtil</code>，因為它提供了一些實用的方法來創建<code translate="No">MediaInfo</code>從視頻和源對象。</p>

<h3 id="Configuring_the_Cast_MediaController">配置Cast MediaController</h3>

<p>要更改在 Cast 會話開始時出現在 Brightcove 視頻視圖中的控制器佈局，請按照以下步驟操作。</p>

<ol class="bcls-tasklist-restart">
	<li><a href="#Extend_the_BrightcoveCastMediaManager">擴展BrightcoveCastMediaManager</a></li>
	<li><a href="#Set_the_MediaControllerConfig">設置 MediaControllerConfig</a></li>
	<li><a href="#Overwrite_the_control_bar_setup">覆蓋控制欄設置</a></li>
</ol>

<h4 id="Extend_the_BrightcoveCastMediaManager">擴展BrightcoveCastMediaManager</h4>

<p>更改默認行為<code translate="No">BrightcoveCastMediaManager</code>，創建一個子類並覆蓋一些關鍵方法：</p>

<ul>
	<li>
	<pre>
<code class="language-java" translate="No">public void updateBrightcoveMediaController(boolean isRemote)</code></pre>

	<p>這個方法被調用<code translate="No">GoogleCastComponent</code>當會話發生變化時；也就是說，當會話開始或結束時。當會話開始時，<code translate="No">isRemote</code>參數將是<code translate="No">true</code>和<code translate="No">setupRemoteController</code>方法被調用。否則，<code translate="No">isRemote</code>將<code translate="No">false</code>和<code translate="No">resetToLocalController</code>叫做。</p>
	</li>
	<li>
	<pre>
<code class="language-java" translate="No">protected void setupRemoteController()</code></pre>

	<p>此方法發出事件<code translate="No">EventType.SET_MEDIA_CONTROLLER_CONFIG</code>與<code translate="No">MediaControllerConfig</code>目的。我們將更多地談論<code translate="No">MediaControllerConfig</code>在本節後面。這個方法也監聽<code translate="No">BrightcoveMediaController.CONTROL_BAR_CREATED</code>事件並通過調用<code translate="No">setupBrightcoveControlBar</code>方法。</p>
	</li>
	<li>
	<pre>
<code class="language-java" translate="No">protected void resetToLocalController()</code></pre>

	<p>該方法負責重置<code translate="No">BrightcoveMediaController</code>通過發射到原始控制器佈局<code translate="No">EventType.RESTORE_DEFAULT_MEDIA_CONTROLLER</code> .</p>
	</li>
	<li>
	<pre>
<code class="language-java" translate="No">protected void setupBrightcoveControlBar(BrightcoveControlBar controlBar)</code></pre>

	<p>一旦<code translate="No">BrightcoveMediaController</code>已使用<code translate="No">MediaControllerConfig</code>，您將可以訪問<code translate="No">BrightcoveControlBar</code>看法。從這裡，您可以訪問UI視圖（例如Buttons），您可以在其中添加<code translate="No">OnClickListener</code>是他們的。</p>
	</li>
</ul>

<h4 id="Set_the_MediaControllerConfig">設置 MediaControllerConfig</h4>

<p>這<code translate="No">MediaControllerConfig</code>是一個配置類，可用於更改默認控件佈局<code translate="No">BrightcoveMediaController</code>班級。在此類中，您可以設置佈局和<code translate="No">OnTouchListener</code>。創建和配置後，可以發出此對象，如下所示：</p>

<pre class="line-numbers">
<code class="language-java" translate="No">Map&lt;String, Object&gt; properties = new HashMap&lt;&gt;();
properties.put(Event.MEDIA_CONTROLLER_CONFIG, myMediaControllerConfig);
eventEmitter.emit(EventType.SET_MEDIA_CONTROLLER_CONFIG,properties);</code></pre>

<p>默認的<code translate="No">MediaControllerConfig</code>對象設置<code translate="No">R.layout.cast_media_controller</code>作為一個單一的佈局<strong>玩</strong>按鈕。單擊後，它將打開一個對話框，其中包含兩個選項：</p>

<ul>
	<li><strong>現在播放</strong> -選擇後，<code translate="No">loadMediaInfo()</code>方法會被調用，視頻將在Chromecast中加載並播放。</li>
	<li><strong>添加到隊列</strong> -選擇後，<code translate="No">addMediaInfo()</code>方法會被調用，並將視頻添加到隊列的末尾。</li>
</ul>

<aside class="bcls-aside bcls-aside--information">如果您想保持相同的 UI 但想在正在投射的視頻中加載附加信息，您可以覆蓋<code translate="No">loadMediaInfo()</code>和<code translate="No">addMediaInfo()</code>方法，並自定義您添加到<code translate="No">MediaInfo</code>目的。</aside>

<h4 id="Overwrite_the_control_bar_setup">覆蓋控制欄設置</h4>

<p>當您的媒體控制器佈局通過發出<code translate="No">MediaControllerConfig</code>， 這<code translate="No">BrightcoveControlBar</code>將創建視圖並<code translate="No">BrightcoveCastMediaManager.setupBrightcoveControlBar()</code>方法將被調用。在這裡，您可以通過ID獲取UI組件並添加適當的偵聽器。</p>

<pre class="line-numbers">
<code class="language-java" translate="No">@Override
protected void setupBrightcoveControlBar(BrightcoveControlBar controlBar) {
   Button playButton = controlBar.findViewById(R.id.cast_play);
   if (playButton != null) {
       playButton.setOnClickListener(new View.OnClickListener() {...});
   }
}</code></pre>

</section>

<!-- <section class="bcls-section">
<h2 id="Cast_plugin_dependencies">Cast plugin dependencies</h2>

<p>The Cast plugin depends on the ExoPlayer Cast Extension:</p>

<pre>
<code class="language-java" translate="No">compile 'com.google.android.exoplayer:extension-cast:2.7.0'</code></pre>

<p>The extension have several dependencies which are listed in the table below:</p>

<table class="bcls-table">
	<thead class="bcls-table__head">
		<tr>
			<th>Name</th>
			<th>Full notation and current version</th>
		</tr>
	</thead>
	<tbody class="bcls-table__body">
		<tr>
			<td><a href="https://developer.android.com/reference/android/support/v7/media/MediaRouter">Mediarouter v7</a></td>
			<td><code translate="No">com.android.support:mediarouter-v7:27.0.0</code></td>
		</tr>
		<tr>
			<td><a href="https://developer.android.com/topic/libraries/support-library/packages#v7">Appcompat v7</a></td>
			<td><code translate="No">com.android.support:appcompat-v7:27.0.0</code></td>
		</tr>
		<tr>
			<td><a href="https://developer.android.com/topic/libraries/support-library/packages#v4">Support v4</a></td>
			<td><code translate="No">com.android.support:support-v4:27.0.0</code></td>
		</tr>
		<tr>
			<td><a href="https://developers.google.com/android/reference/com/google/android/gms/cast/package-summary">Cast Framework</a></td>
			<td><code translate="No">com.google.android.gms:play-services-cast-framework:11.4.2</code></td>
		</tr>
		<tr>
			<td><a href="https://github.com/google/ExoPlayer/tree/release-v2/library/core">ExoPlayer Core</a></td>
			<td><code translate="No">com.google.android.exoplayer:exoplayer-core:2.7.0</code></td>
		</tr>
		<tr>
			<td><a href="https://github.com/google/ExoPlayer/tree/release-v2/library/ui">ExoPlayer UI</a></td>
			<td><code translate="No">com.google.android.exoplayer:exoplayer-ui:2.7.0</code></td>
		</tr>
	</tbody>
</table>
</section> -->

<!-- <section class="bcls-section">
<h2 id="Limitations">Limitations</h2>

<p>With the current Brightcove Native SDK for Android release, certain Video Cloud features have limited support, or are not supported when using the Cast plugin with the Google sample receiver app:</p>

<ul>
	<li>Captions
	<ul>
		<li>Only in-manifest captions with Dynamic Delivery DASH display as expected when using the Cast plugin with the Google sample receiver app.</li>
		<li>In-manifest captions with HLS and Sidecar captions in any video configuration are not currently supported when using the Cast plugin with the Google sample receiver app.</li>
	</ul>
	</li>
	<li>Widevine Modular DRM is not supported when using the Cast plugin with the Google sample receiver app.</li>
	<li>Multiple Audio Tracks are not supported when using the Cast plugin with the Google sample receiver app.</li>
	<li>Client-side and Server-side Advertising is not supported when using the Cast plugin with the Google sample receiver app.</li>
	<li>Live and Live DVR streams are not supported when using the Cast plugin with the Google sample receiver app.</li>
	<li>Casting Offline Videos is not currently supported. When you download a video, the Source url is changed to point to a local file. If you then try casting that Video, the plugin will pick the local source but the Chromecast device will not be able to request the video.</li>
</ul>

<h3 id="Handling_currently_unsupported_features">Handling currently unsupported features</h3>

<p>The Cast plugin is responsible for gathering MediaInfo data, such as video url, title, description, and poster image, and casting it to your connected Chromecast device. Note that successful playback of the Video and display of the metadata ultimately depends on the Application Receiver.</p>

<p>It is the developer's responsibility to evaluate the Application Receiver for what it supports, and its limitations. Therefore, the developer should implement UI elements that inform the user what can or can’t be cast. For example, if the Application Receiver does not support Videos with DRM or Ads, your Android app must handle these scenarios.</p>
</section> -->

<section class="bcls-section">
<h2 id="Known_Issues">已知的問題</h2>

<h3>Android 9</h3>

<p>在 Android 9 及更高版本上使用 Chromecast 時，您需要包含一個<code translate="No">FOREGROUND_SERVICE</code>允許。這允許應用程序在應用程序處於後台並返回前台時使用通知來控制投射會話。</p>

<p>這<code translate="No">uses-permission</code>標籤應該添加到應用程序的<strong>AndroidManifest.xml</strong>文件，如下：</p>

<pre>
<code class="language-java" translate="No">&lt;uses-permission android:name="android.permission.FOREGROUND_SERVICE"/&gt;</code></pre>

<!-- <h3>Volume control</h3>

<p>The volume control in the Cast dialog may not decrease all the way to zero on the sending device. When using the volume control in the Cast dialog, or the volume buttons on the sending device, the displayed volume level may jump back up slightly to show a non-zero value on the sender. However, the receiver will display a non-zero value. This is a behavior with the Google Cast dialog, and not within the Brightcove Android SDK.</p> -->

<h4>Google Play服務</h4>

<p>如果發件人的 Google Play 服務版本不是最新的，則可能無法創建 Casting 連接。當發送方的 Google Play 服務（尤其是 Cast 服務框架）過期時，您可能無法成功創建 Cast 連接。這可以通過通過 Google Play 商店更新發件人的 Google Play 服務來解決。</p>
</section>
</article>