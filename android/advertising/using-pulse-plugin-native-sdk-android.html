---
title:使用帶有 Android 原生 SDK 的 Pulse 插件
description:在本主題中，您將學習如何將 Pulse 插件與 Brightcove 的 Android 原生 SDK 結合使用。
parent: Advertising 
grandparent: Android Development
---
 <h1>{{ page.title }}</h1>
<article class="bcls-article">
  <summary>{{ page.description }}</summary>


<section class="bcls-section">
<h2 id="Introduction">介紹</h2>
<p>Brightcove的Pulse插件使您能夠將Invidi的Pulse SDK與Android的Brightcove本機SDK集成在一起。Pulse是視頻廣告平台。有關廣告系列和配置的詳細信息，請參見<a href="https://docs.invidi.com/reader/_hzObZcxZxk0Ct6OlYIk9A/RAeqPLOCQZ5XttfyEPlg~w">用戶指南</a>。</p>
<aside class="bcls-aside bcls-aside--information">筆記：
  <ul>
    <li>
      適用於 Android 6.12 及更高版本的 Brightcove Native SDK 支持。
    </li>
    <li>
      此功能已經過 Pulse SDK 版本 2.5.19.9.0 的測試。我們建議使用此版本。
    </li>
  </ul>
</aside>
</section>

<section class="bcls-section">
<h2 id="Steps">腳步</h2>
<p>
  在Pulse平台中創建廣告系列後，您可以開始使用適用於Android的Brightcove Native SDK的Pulse插件。請按照以下步驟將Pulse插件與您的項目集成：
</p>
<ol class="bcls-tasklist">
	<li>
    <p>
      在您的模塊中<strong>build.gradle</strong>文件，添加Pulse插件依賴項。
    </p>
    <pre class="line-numbers"><code class="language-java" translate="No">dependencies {
    implementation 'com.brightcove.player:android-pulse-plugin:6.12.0'
}</code></pre>
  </li>
  <li>
    <p>
      下載<a href="https://docs.invidi.com/reader/_hzObZcxZxk0Ct6OlYIk9A/H1FP_BHOo3Tcm3H29a73ww">Pulse SDK .aar文件</a>。
    </p>
  </li>
  <li>
    <p>
      在你的<strong>應用/庫</strong>文件夾，打開<strong>build.gradle</strong>文件中的文件。修改以下內容：
    </p>
    <pre class="line-numbers"><code class="language-java" translate="No">dependencies {
    implementation fileTree(dir: 'libs', include: ['*.jar', <span class="bcls-highlight">'*.aar'</span>])
}</code></pre>
  </li>
  <li>
    <p>
      在你的<strong>MainActivity.java</strong>文件，通過實例化一個來初始化Pulse Plugin <code translate="No">PulseComponent</code>使用為您的廣告系列創建的Pulse主機URL。
    </p>
    <pre class="line-numbers"><code class="language-java" translate="No">@Override
protected void onCreate(Bundle savedInstanceState) {
    // ...
    // Creating pulse component
    PulseComponent pulseComponent = new PulseComponent(
            &quot;<span class="bcls-input">your pulse host url</span>&quot;,
            brightcoveVideoView.getEventEmitter(),
            brightcoveVideoView);
    // ...
}</code></pre>
  </li>
  <li>
    <p>
      設置<code translate="No">PulseComponent</code>聽眾。
    </p>
    <pre class="line-numbers"><code class="language-java" translate="No">pulseComponent.setListener(new PulseComponent.Listener() {
  @NonNull
  @Override
  public PulseSession onCreatePulseSession(
    @NonNull String hostUrl,
    @NonNull Video video,
    @NonNull ContentMetadata contentMetadata,
    @NonNull RequestSettings requestSettings) {
    // See step 3a
    return Pulse.createSession(contentMetadata, requestSettings);
  }

  @Override
  public void onOpenClickthrough(@NonNull PulseVideoAd pulseVideoAd) {
  }
});</code></pre>
  </li>
  <li>
    <p>
      實施<code translate="No">onCreatePulseSession</code>方法，它創建一個<code translate="No">PulseSession</code>並將其返回給<code translate="No">PulseComponent</code>。共有三個參數：
    </p>
    <ul>
      <li>
        脈衝主機
      </li>
      <li>
        內容元數據設置
      </li>
      <li>
        請求設置
      </li>
    </ul>
    <br/>

    <pre class="line-numbers"><code class="language-java" translate="No">@NonNull
@Override
public PulseSession onCreatePulseSession(
    @NonNull String hostUrl,
    @NonNull Video video,
    @NonNull ContentMetadata contentMetadata,
    @NonNull RequestSettings requestSettings) {
  // Set the pulse Host:
  Pulse.setPulseHost(pulseHostUrl, null, null);

  // Content metadata settings
  contentMetadata.setCategory(&quot;skip-always&quot;);
  contentMetadata.setTags(Collections.singletonList(&quot;standard-linears&quot;));
  contentMetadata.setIdentifier(&quot;demo&quot;);

  // Request Settings:
  // Adding mid-rolls
  List&lt;Float&gt; midrollCuePoints = new ArrayList&lt;&gt;();
  midrollCuePoints.add(60f);
  requestSettings.setLinearPlaybackPositions(midrollCuePoints);

  // Create and return the PulseSession
  return Pulse.createSession(contentMetadata, requestSettings);
}</code></pre>
  </li>
  <li>
    <p>
      實施<code translate="No">onOpenClickthrough</code>方法，當<strong>學到更多</strong>單擊線性廣告中的按鈕。此回調的典型操作是使用預期的URL打開瀏覽器。
    </p>
    <pre class="line-numbers"><code class="language-java" translate="No">@Override
public void onOpenClickthrough(@NonNull PulseVideoAd pulseVideoAd) {
  Intent intent = new Intent(Intent.ACTION_VIEW)
    .setData(Uri.parse(pulseVideoAd.getClickthroughURL().toString()));
  brightcoveVideoView.getContext().startActivity(intent);
  pulseVideoAd.adClickThroughTriggered();
}</code></pre>
  </li>
  <li>
    <p>
      播放您的內容
    </p>
    <pre class="line-numbers"><code class="language-java" translate="No">Catalog catalog = new Catalog.Builder(
  eventEmitter,
  getString(R.string.account))
  .setPolicy(getString(R.string.policy))
  .build();

catalog.findVideoByID(getString(R.string.videoId), new VideoListener() {
  // Add the video found to the queue with add().
  // Start playback of the video with start().
  @Override
  public void onVideo(Video video) {
    brightcoveVideoView.add(video);
    brightcoveVideoView.start();
  }
});</code></pre>
  </li>
</ol>
</section>

<section class="bcls-section">
<h2 id="Pulse_Pause_Ads">脈衝暫停廣告</h2>
<p>當 Pulse 活動配置了“暫停廣告”時，Pulse 插件將在內容暫停時向用戶顯示。</p>
</section>

<section class="bcls-section">
<h2 id="Error_handling">錯誤處理</h2>
<p>所有錯誤都將使用EventType.AD_ERROR事件浮出水面給開發人員，如下所示：</p>
<pre class="line-numbers"><code class="language-java" translate="No">eventEmitter.on(EventType.AD_ERROR, event -&gt; {
    Throwable error = event.getProperty(Event.ERROR, Throwable.class);
    Log.e(TAG, &quot;AD_ERROR: &quot;, error);
});</code></pre>
</section>

<section class="bcls-section">
<h2 id="UI_Customization">用戶界面定制</h2>
<p>在內部，Pulse插件會誇大<code translate="No">PulseAdView</code>使用<code translate="No">R.layout.pulse_ad_view</code>佈局ID。對於其他佈局，您可以創建一個具有相同名稱的佈局文件並將其添加到<strong>分辨率/佈局</strong>目錄。這會覆蓋默認佈局。 </p>
<p>
  使用以下 ID 替換默認值：
</p>
<figure class="bcls-figure">
  <img class="bcls-image--no-border" width="800" src="/assets/images/android/advertising/component-views.png/component-views.png" alt="Component Views">
  <figcaption class="bcls-caption--image">組件視圖</figcaption>
</figure>
<table class="bcls-table">
  <thead class="bcls-table__head">
    <tr>
      <th>指數</th>
      <th>視圖類型</th>
      <th>查看 ID</th>
    </tr>
  </thead>
  <tbody class="bcls-table__body">
    <tr>
      <td>一種</td>
      <td>文本視圖</td>
      <td><code translate="No">pulse_ad_number_view</code></td>
    </tr>
    <tr>
      <td>乙</td>
      <td>文本視圖</td>
      <td><code translate="No">pulse_ad_countdown_view</code></td>
    </tr>
    <tr>
      <td>C</td>
      <td>文本視圖</td>
      <td><code translate="No">pulse_ad_name_view</code></td>
    </tr>
    <tr>
      <td>d</td>
      <td>文本視圖</td>
      <td><code translate="No">pulse_ad_learn_more_view</code></td>
    </tr>
    <tr>
      <td>E</td>
      <td>文本視圖</td>
      <td><code translate="No">pulse_skip_ad_view</code></td>
    </tr>
  </tbody>
</table>
</section>

<section class="bcls-section">
<h2 id="Complete_code_sample">完整的代碼示例</h2>
<p>這是將Pulse插件與Android Native SDK一起使用的完整代碼示例。</p>

<details>
    <summary><h2 id="Activity">活動</h2></summary>
  <p>
    這是完整活動代碼的示例：
  </p>
  <pre class="line-numbers"><code class="language-java" translate="No">public class MainActivity extends AppCompatActivity {

    @Override
    protected void onCreate(Bundle savedInstanceState) {
      setContentView(R.layout.activity_main);

      final BrightcoveVideoView videoView = findViewById(R.id.video_view);
      super.onCreate(savedInstanceState);

      EventEmitter eventEmitter = videoView.getEventEmitter();

      // Pulse setup
      PulseComponent pulseComponent = new PulseComponent(
          &quot;https://pulse-demo.videoplaza.tv&quot;,
          eventEmitter,
          videoView);

      pulseComponent.setListener(new PulseComponent.Listener() {
          @NonNull
          @Override
          public PulseSession onCreatePulseSession(
                @NonNull String pulseHostUrl,
                @NonNull Video video,
                @NonNull ContentMetadata contentMetadata,
                @NonNull RequestSettings requestSettings) {
            Pulse.setPulseHost(pulseHostUrl, null, null);
            contentMetadata.setCategory(&quot;skip-always&quot;);
            contentMetadata.setTags(Collections.singletonList(&quot;standard-linears&quot;));
            contentMetadata.setIdentifier(&quot;demo&quot;);

            // Adding mid-rolls
            List&lt;Float&gt; midrollCuePoints = new ArrayList&lt;&gt;();
            midrollCuePoints.add(60f);
            requestSettings.setLinearPlaybackPositions(midrollCuePoints);

            return Pulse.createSession(
              contentMetadata,
              requestSettings);
          }

          @Override
          public void onOpenClickthrough(@NonNull PulseVideoAd ad) {
            Intent intent = new Intent(Intent.ACTION_VIEW)
              .setData(Uri.parse(ad.getClickthroughURL().toString()));
            videoView.getContext().startActivity(intent);
            ad.adClickThroughTriggered();
          }
      });

      Catalog catalog = new Catalog.Builder(eventEmitter, &quot;YourAccountId&quot;)
          .setPolicy(&quot;YourPolicyKey&quot;)
          .build();
      catalog.findVideoByID(&quot;YourVideoId&quot;, new VideoListener() {

        // Add the video found to the queue with add().
        // Start playback of the video with start().
        @Override
        public void onVideo(Video video) {
          videoView.add(video);
          videoView.start();
        }
      });
    }
  }</code></pre>
</details>
<br/>

<details>
    <summary><h2 id="Layout">佈局</h2></summary>
  <p>
    這是示例佈局代碼的示例<code translate="No">R.layout.pulse_ad_view</code>。
  </p>
  <pre class="line-numbers"><code class="language-xml" translate="No">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;
  &lt;RelativeLayout xmlns:android=&quot;http://schemas.android.com/apk/res/android&quot;
      xmlns:tools=&quot;http://schemas.android.com/tools&quot;
      android:layout_width=&quot;match_parent&quot;
      android:layout_height=&quot;match_parent&quot;&gt;

      &lt;RelativeLayout
          android:id=&quot;@+id/view_ad_details&quot;
          android:layout_width=&quot;match_parent&quot;
          android:layout_height=&quot;wrap_content&quot;
          android:background=&quot;@drawable/pulse_skip_button_background_selector&quot;&gt;

          &lt;TextView
              android:id=&quot;@+id/pulse_ad_name_view&quot;
              android:layout_width=&quot;wrap_content&quot;
              android:layout_height=&quot;wrap_content&quot;
              android:layout_alignParentTop=&quot;true&quot;
              android:layout_marginTop=&quot;4dp&quot;
              android:paddingTop=&quot;4dp&quot;
              android:paddingStart=&quot;8dp&quot;
              android:paddingEnd=&quot;8dp&quot;
              android:textColor=&quot;@color/white&quot;
              android:background=&quot;@color/bmc_live&quot;
              android:textStyle=&quot;bold&quot;
              tools:text=&quot;Preroll blue&quot;/&gt;

          &lt;TextView
              android:id=&quot;@+id/pulse_ad_number_view&quot;
              android:layout_width=&quot;wrap_content&quot;
              android:layout_height=&quot;wrap_content&quot;
              android:paddingStart=&quot;8dp&quot;
              android:paddingEnd=&quot;4dp&quot;
              android:paddingBottom=&quot;4dp&quot;
              android:layout_marginBottom=&quot;8dp&quot;
              android:layout_below=&quot;@id/pulse_ad_name_view&quot;
              android:textColor=&quot;@color/white&quot;
              android:background=&quot;@color/white_semi_trans&quot;
              tools:text=&quot;Ad (1 of 2)&quot;/&gt;

          &lt;TextView
              android:id=&quot;@+id/pulse_ad_countdown_view&quot;
              android:layout_width=&quot;wrap_content&quot;
              android:layout_height=&quot;wrap_content&quot;
              android:paddingStart=&quot;4dp&quot;
              android:paddingEnd=&quot;4dp&quot;
              android:paddingBottom=&quot;4dp&quot;
              android:layout_marginBottom=&quot;4dp&quot;
              android:layout_below=&quot;@id/pulse_ad_name_view&quot;
              android:layout_toEndOf=&quot;@+id/pulse_ad_number_view&quot;
              android:textColor=&quot;@color/green_almost_opaque&quot;
              android:text=&quot;&quot;
              tools:text=&quot;00:06&quot;/&gt;

          &lt;TextView
              android:id=&quot;@+id/pulse_ad_learn_more_view&quot;
              android:layout_width=&quot;wrap_content&quot;
              android:layout_height=&quot;wrap_content&quot;
              android:layout_marginStart=&quot;@dimen/pulse_ad_learn_more_margin_left&quot;
              android:layout_marginTop=&quot;@dimen/pulse_ad_learn_more_margin_top&quot;
              android:layout_marginEnd=&quot;@dimen/pulse_ad_learn_more_margin_right&quot;
              android:layout_marginBottom=&quot;@dimen/pulse_ad_learn_more_margin_bottom&quot;
              android:layout_alignTop=&quot;@id/pulse_ad_name_view&quot;
              android:layout_alignBottom=&quot;@id/pulse_ad_countdown_view&quot;
              android:layout_alignParentEnd=&quot;true&quot;
              android:background=&quot;@drawable/pulse_learn_more_button_background&quot;
              android:paddingStart=&quot;12dp&quot;
              android:paddingEnd=&quot;12dp&quot;
              android:padding=&quot;@dimen/pulse_ad_learn_more_padding_default&quot;
              android:gravity=&quot;center&quot;
              android:shadowColor=&quot;@color/brightcove_semitransparent&quot;
              android:shadowDx=&quot;-1&quot;
              android:shadowDy=&quot;1&quot;
              android:shadowRadius=&quot;1.5&quot;
              android:text=&quot;@string/pulse_message_learn_more&quot;
              android:textColor=&quot;@color/pulse_button_text_color&quot;
              android:nextFocusUp=&quot;@id/pulse_skip_ad_view&quot;
              android:textSize=&quot;@dimen/pulse_message_text_size&quot;
              android:visibility=&quot;gone&quot;
              tools:visibility=&quot;visible&quot; /&gt;

      &lt;/RelativeLayout&gt;

      &lt;TextView
          android:id=&quot;@+id/pulse_skip_ad_view&quot;
          android:layout_width=&quot;wrap_content&quot;
          android:layout_height=&quot;wrap_content&quot;
          android:maxWidth=&quot;164dp&quot;
          android:layout_alignParentEnd=&quot;true&quot;
          android:layout_centerVertical=&quot;true&quot;
          android:layout_marginBottom=&quot;@dimen/pulse_skip_ad_margin_bottom&quot;
          android:background=&quot;@drawable/pulse_skip_button_background_selector&quot;
          android:ellipsize=&quot;none&quot;
          android:gravity=&quot;center&quot;
          android:maxLines=&quot;2&quot;
          android:paddingStart=&quot;@dimen/pulse_skip_ad_padding_left&quot;
          android:paddingEnd=&quot;@dimen/pulse_skip_ad_padding_right&quot;
          android:paddingTop=&quot;@dimen/pulse_skip_ad_padding&quot;
          android:paddingBottom=&quot;@dimen/pulse_skip_ad_padding&quot;
          android:scrollHorizontally=&quot;false&quot;
          android:shadowColor=&quot;@color/brightcove_shadow&quot;
          android:shadowDx=&quot;-1&quot;
          android:shadowDy=&quot;1&quot;
          android:shadowRadius=&quot;1.5&quot;
          android:text=&quot;@string/pulse_message_skip_ad&quot;
          android:textColor=&quot;@color/pulse_button_text_color&quot;
          android:textSize=&quot;@dimen/pulse_message_text_size&quot;
          android:visibility=&quot;gone&quot;
          android:nextFocusUp=&quot;@id/pulse_ad_learn_more_view&quot;
          android:focusable=&quot;true&quot;
          tools:visibility=&quot;visible&quot;/&gt;

  &lt;/RelativeLayout&gt;
  </code></pre>
</details>
</section>
</article>