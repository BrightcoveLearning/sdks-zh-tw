---
title: '一步步：使用 Swift 的簡單電視視頻應用' 
description:在本主題中，您將學習如何使用Brightcove Player SDK for tvOS構建一個簡單的視頻播放應用程序，該應用程序可在Apple TV或Xcode模擬器上播放。您將使用 Swift 編程語言構建它。
parent: Basics 
grandparent: tvOS Development
---
 <h1>{{ page.title }}</h1>
<article class="bcls-article">
  <summary>{{ page.description }}</summary>

<section class="bcls-section">
<h2 id="Overview">概述</h2>

<p class="video-cloud-only">此示例播放從<a href="https://apis.support.brightcove.com/playback/getting-started/overview-playback-api.html">Brightcove 播放 API</a>，這是最新且推薦的 API，用於從您的 Video Cloud 庫中檢索內容。</p>

<p class="player-only">此示例播放來自內部視頻文件數組的視頻。</p>

<p class="video-cloud-only">要使用 Playback API，您需要一個 Policy Key。如果您不熟悉策略密鑰，請參閱<a href="https://apis.support.brightcove.com/policy/getting-started/overview-policy-api.html">策略API概述</a>。</p>

<!-- <aside class="bcls-aside bcls-aside--tip">This example is written in Swift, but you can also experiment with Objective-C. See the <a href="https://github.com/BrightcoveOS/ios-player-samples/tree/master/OUX/BasicOUXtvOSPlayer/objc">Obj-C version of the Basic tvOS player with the Once UX plugin</a> sample.</aside> -->
</section>

<section class="bcls-section">
<h2 id="Get_started">開始吧</h2>

<p class="player-only">請按照以下步驟熟悉如何設置使用Brightcove Player SDK for tvOS的應用程序項目。您可以查看以下各項的完整代碼：</p>

<ol class="player-only">
	<li><a href="#appdelegate">AppDelegate</a></li>
	<li><a href="#viewControllerPerform">視圖控制器</a></li>
</ol>

<div class="video-cloud-only">
<p>有兩種方法可以試用此示例：</p>

<h3>下載樣本</h3>

<p>下載整個Xcode項目進行實驗。</p>

<ol>
	<li>克隆或下載<a href="https://github.com/BrightcoveOS/ios-player-samples">適用於iOS的本機SDK示例</a>到您的本地系統。</li>
	<li>導航到<a href="https://github.com/BrightcoveOS/ios-player-samples/tree/master/Player/AppleTV/swift">播放器/ AppleTV / swift</a>示例應用程序。</li>
	<li>跑過<code translate="No">pod install</code>命令。</li>
	<li>打開並運行新創建的工作區。</li>
</ol>

<p>有關詳細信息，請參見<a href="/getting-started/running-sample-apps-native-sdk-ios.html">針對iOS / tvOS的Native SDK運行示例應用</a>文檔。</p>

<h3>按照本指南中的步驟構建應用</h3>

<p>請按照以下步驟熟悉如何設置使用Brightcove Player SDK for tvOS的應用程序項目。您可以查看以下各項的完整代碼：</p>

<ol>
	<li><a href="#appdelegate">AppDelegate</a></li>
	<li><a href="#viewController">視圖控制器</a></li>
</ol>
</div>
</section>

<section class="bcls-section">
<h2 id="Create_the_project">建立專案</h2>

<p>在 Xcode 中設置一個項目。然後將 SDK 以及任何依賴項添加到項目中。</p>

<h3>設置 Xcode 項目</h3>

<p>為該應用程序創建一個新的Xcode項目。</p>

<ol class="bcls-tasklist">
	<li>
	<p>開始在 Xcode 中創建一個新的 tvOS 項目。選擇<strong>創建一個新的 Xcode 項目</strong> .</p>

	<figure class="bcls-figure"><img class="bcls-image--no-border" alt="Create project" src="//learning-services-media.brightcove.com/doc-assets/device-sdks/ios/getting-started/quick-start/quick-start-welcome.png" />
	<figcaption class="bcls-caption--image">建立專案</figcaption>
	</figure>
	</li>
	<li>
	<p>選擇一個tvOS <strong>單視圖應用程序</strong>為模板，然後選擇<strong>下一個</strong>。</p>

	<figure class="bcls-figure"><img class="bcls-image--no-border" alt="Choose project template" src="//learning-services-media.brightcove.com/doc-assets/device-sdks/tvos/getting-started/quick-start-swift/quick-start-choose-project-template.png" />
	<figcaption class="bcls-caption--image">選擇項目模板</figcaption>
	</figure>
	</li>
	<li>
	<p>設置項目信息如下：</p>

	<ul>
		<li><strong>產品名稱：</strong>簡單視頻播放</li>
		<li><strong>團隊：</strong>沒有任何
		<p>團隊字段是可選的。如果要在App Store上分發應用程序，則需要通過Apple Developer Program選擇您所屬的團隊。代碼簽名需要團隊名稱。在此示例中，我們將不選擇任何內容。</p>
		</li>
		<li><strong>機構名稱：</strong>您的公司名稱</li>
		<li><strong>組織標識符：</strong> com.example-公司<br />
		這使得應用商店的產品名稱是唯一的。</li>
		<li><strong>語：</strong>迅速</li>
	</ul>

	<figure class="bcls-figure"><img class="bcls-image--no-border" alt="Add project information" src="//learning-services-media.brightcove.com/doc-assets/device-sdks/tvos/getting-started/quick-start-swift/project-options.png" />
	<figcaption class="bcls-caption--image">添加項目信息</figcaption>
	</figure>
	</li>
	<li>
	<p>選擇要保存項目並創建它的位置。</p>

	<figure class="bcls-figure"><img class="bcls-image--no-border" alt="Save the project" src="//learning-services-media.brightcove.com/doc-assets/device-sdks/tvos/getting-started/quick-start-swift/workspace.png" />
	<figcaption class="bcls-caption--image">保存項目</figcaption>
	</figure>
	</li>
	<li>現在關閉項目（是的，關閉它-這很重要！）</li>
</ol>

<h3 id="dependencies">將SDK及其依賴項添加到您的項目中</h3>

<p>將 SDK 及其依賴項添加到您的項目的最簡單方法是使用 CocoaPods。</p>

<p>CocoaPods是一個依賴項管理器，可將庫添加到您的項目中。它不是必需的，但是使安裝更容易。要安裝 CocoaPods，請參閱<a href="//cocoapods.org">可可豆</a>地點。</p>

<aside class="bcls-aside bcls-aside--warning">
<ul>
	<li>需要CocoaPods 1.0版或更高版本。</li>
	<li>使用 CocoaPods（<code translate="No">pod</code>工具）將修改項目文件。在執行此操作之前，您可能需要進行備份。</li>
</ul>
</aside><aside class="bcls-aside bcls-aside--tip">輕鬆創建和更新<code translate="No">Podfile</code>，你可以在裡面執行以下步驟<a href="https://cocoapods.org/app">可可豆應用</a> .</aside>

<ol class="bcls-tasklist">
	<li>
	<p>在您的項目文件夾中，創建一個純文本文件，名為<strong>播客文件</strong>（無文件擴展名）。</p>
	</li>
	<li>
	<p>使用文本編輯器，將以下代碼行添加到 Podfile 並保存。此代碼執行以下操作：</p>

	<ul>
		<li>第1行：定義GitHub源。</li>
		<li>第3行：將 Pod 設置為使用框架而不是靜態庫。</li>
		<li>第5行：定義tvOS平台版本。</li>
		<li>
		<p>7-9行：安裝Brightcove Native Player SDK。</p>

		<ol>
			<li>從中獲取當前的Native SDK版本<a href="/ios/basics/overview-brightcove-player-sdk-ios.html#Download_the_SDK">適用於iOS的Brightcove Native SDK概述</a>文檔。</li>
			<li>替換值<code translate="No"> '6.3.11'</code>使用當前的SDK版本號。</li>
			<li>
			<p>有關管理依賴項的更多信息，請參見<a href="https://cocoacasts.com/how-to-manage-dependencies-with-cocoapods/">如何使用CocoaPods管理依賴項</a>文章。</p>
			</li>
		</ol>
		</li>
	</ul>

	<pre class="line-numbers" data-start="1">
<code class="language-swift" translate="No">source 'https://github.com/brightcove/BrightcoveSpecs.git'

use_frameworks!

platform :tvos, '11.0' # (or whatever version you want)

target 'Simple-Video-Playback' do
	pod 'Brightcove-Player-Core/dynamic', '6.3.11'
end</code></pre>

	<aside class="bcls-aside bcls-aside--tip">筆記：
	<ul>
		<li>這<code translate="No">target</code>屬性用於 CocoaPods 1.0 及更新版本。</li>
		<li>您需要以 Brightcove Native SDK 核心 v6.3+ 為目標來支持 UI 控件。</li>
	</ul>
	</aside>
	</li>
	<!--							<p class="text-warning">ReactiveCocoa will be added to your project as a part of the Brightcove SDK.</p>-->
	<li>
	<p>打開終端會話並導航到您的<strong>簡單視頻播放</strong> Xcode項目文件夾。</p>

	<figure class="bcls-figure"><img class="bcls-image--no-border" alt="Terminal session" src="//learning-services-media.brightcove.com/doc-assets/device-sdks/ios/getting-started/quick-start/quick-start-terminal.png" />
	<figcaption class="bcls-caption--image">終端會話</figcaption>
	</figure>
	</li>
	<li>
	<p>在終端會話中，鍵入命令</p>

	<pre class="line-numbers" data-start="1">
<code class="language-swift" translate="No">pod install</code></pre>

	<p>然後按<strong>返回</strong>運行它。您應該會在終端中看到一系列消息，表明 Brightcove Player SDK 已添加到您的項目中。</p>
	</li>
	<li>
	<p><strong>注意最後一行</strong>，這很重要 — 從現在開始，您必須打開 <em>Simple-Video-Playback.xcworkspace</em> Xcode 中的文件，<strong>不是</strong>這 <em>Simple-Video-Playback.xcodeproj</em> 文件。這<code translate="No">pod install</code>命令創建這個<code translate="No">.xcworkspace</code>您的項目的文件。</p>
	</li>
</ol>

<aside class="bcls-aside bcls-aside--tip">如果你不想使用 CocoaPods ，你可以<a href="https://github.com/brightcove/brightcove-player-sdk-ios/releases">下載最新版本的SDK</a>並手動將其添加到您的項目中。</aside>
</section>

<section class="bcls-section">
<h2 id="Code_the_video_app">編碼視頻應用</h2>

<p>為簡單的視頻播放應用程序創建代碼。</p>

<h3 id="appdelegate">設置應用的音頻行為</h3>

<p>音頻會話處理應用級別的音頻行為。進一步了解<a href="https://developer.apple.com/documentation/avfoundation/avaudiosession">AVAudioSession</a>班級。</p>

<aside class="bcls-aside bcls-aside--tip">您可以從多個音頻會話類別和設置中進行選擇，以自定義應用的音頻行為。<a href="https://developer.apple.com/library/archive/documentation/Audio/Conceptual/AudioSessionProgrammingGuide/AudioSessionCategoriesandModes/AudioSessionCategoriesandModes.html#//apple_ref/doc/uid/TP40007875-CH10">選擇最佳音頻會話類別</a>為您的應用程序。</aside>

<p>對於此示例，我們將使用<a href="https://developer.apple.com/documentation/avfoundation/avaudiosession/category/1616509-playback">回放</a>類別。即使在屏幕被鎖定並且鈴聲/靜音開關設置為靜音時，它也會播放音頻。由於我們正在播放視頻，因此我們將使用<a href="https://developer.apple.com/documentation/avfoundation/avaudiosession/mode/1616623-movieplayback">電影回放</a>模式。為簡單起見，我們將此代碼放在 App Delegate 中。</p>

<ol class="bcls-tasklist">
	<li>
	<p>在您的項目中，打開“App Delegate"文件（<strong> AppDelegate.swift</strong>）。</p>
	</li>
	<li>
	<p>在裡面<code translate="No">didFinishLaunchingWithOptions</code>功能，添加代碼以設置音頻會話類別。確保您導入<code translate="No">AVFoundation</code>框架。</p>

	<pre class="line-numbers" data-start="1">
<code class="language-swift" translate="No">//
//  AppDelegate.swift
//  Simple-Video-Playback
//
//  Copyright © 2018 Brightcove. All rights reserved.
//

import UIKit
<span class="bcls-highlight">import AVFoundation</span>

@UIApplicationMain
class AppDelegate: UIResponder, UIApplicationDelegate {

  var window: UIWindow?

  func application(_ application: UIApplication, didFinishLaunchingWithOptions launchOptions: [UIApplicationLaunchOptionsKey: Any]?) -&gt; Bool {
    // Override point for customization after application launch.
<span class="bcls-highlight">        var categoryError :NSError?;
    var success: Bool;
    do {
      try AVAudioSession.sharedInstance().setCategory(.playback, mode: .moviePlayback, options: .duckOthers)
      success = true;
    } catch let error as NSError {
      categoryError = error;
      success = false;
    }

    if !success {
      print("AppDelegate Debug - Error setting AVAudioSession category.  Because of this, there may be no sound. \(categoryError!)");
    }</span>

    return true
  }

  func applicationWillResignActive(_ application: UIApplication) {
    // Sent when the application is about to move from active to inactive state. This can occur for certain types of temporary interruptions (such as an incoming phone call or SMS message) or when the user quits the application and it begins the transition to the background state.
    // Use this method to pause ongoing tasks, disable timers, and throttle down OpenGL ES frame rates. Games should use this method to pause the game.
  }

  func applicationDidEnterBackground(_ application: UIApplication) {
    // Use this method to release shared resources, save user data, invalidate timers, and store enough application state information to restore your application to its current state in case it is terminated later.
    // If your application supports background execution, this method is called instead of applicationWillTerminate: when the user quits.
  }

  func applicationWillEnterForeground(_ application: UIApplication) {
    // Called as part of the transition from the background to the active state; here you can undo many of the changes made on entering the background.
  }

  func applicationDidBecomeActive(_ application: UIApplication) {
    // Restart any tasks that were paused (or not yet started) while the application was inactive. If the application was previously in the background, optionally refresh the user interface.
  }

  func applicationWillTerminate(_ application: UIApplication) {
    // Called when the application is about to terminate. Save data if appropriate. See also applicationDidEnterBackground:.
  }

}</code></pre>
	</li>
</ol>

<h3>構建視圖控制器</h3>

<p class="video-cloud-only">更新視圖控制器類以從 Brightcove Playback API 播放視頻。</p>

<p class="player-only">更新視圖控制器類以從遠程 URL 播放視頻。</p>

<ol class="bcls-tasklist">
	<li>
	<p>在您的項目中，打開View Controller文件（<strong> ViewController.swift</strong>）。</p>
	</li>
</ol>

<div class="video-cloud-only">
<h4>導入本機SDK</h4>

<p>儘管iOS的Brightcove Native Player SDK是用Obj-C編寫的，但是我們可以簡單地將框架模塊導入到我們的Swift項目中。</p>

<ol class="bcls-tasklist">
	<li>
	<p>現有以下<code translate="No">import</code>指令，添加以下內容以導入Brightcove Native Player SDK：</p>

	<pre class="line-numbers" data-start="9">
<code class="language-swift" translate="No">import BrightcovePlayerSDK</code></pre>
	</li>
</ol>

<h4>用您的價值觀定制項目</h4>

<p>添加值以訪問您的Video Cloud帳戶。</p>

<ol class="bcls-tasklist">
	<li>
	<p>以下<code translate="No">import</code>指令，為以下內容添加您自己的值：</p>

	<ul>
		<li>
		<p>第12行：定義您的Brightcove播放API策略密鑰。此示例播放從<a href="https://apis.support.brightcove.com/playback/getting-started/overview-playback-api.html">Brightcove 播放 API</a>，這是最新且推薦的 API，用於從您的 Video Cloud 庫中檢索內容。如果您不熟悉策略密鑰，請參閱<a href="https://apis.support.brightcove.com/policy/getting-started/overview-policy-api.html">策略API概述</a>。</p>
		</li>
		<li>第13行：定義您的視頻雲帳戶ID</li>
		<li>
		<p>第14行：定義您的視頻雲視頻ID</p>
		</li>
	</ul>

	<pre class="line-numbers" data-start="11">
<code class="language-swift" translate="No">fileprivate struct playbackConfig {
  static let policyKey = "<span class="bcls-input">your policy key</span>"
  static let accountID = "<span class="bcls-input">your account id</span>"
  static let videoID = "<span class="bcls-input">your video id</span>"
}</code></pre>
	</li>
</ol>

<h4>創建一個視圖變量</h4>

<ol class="bcls-tasklist">
	<li>
	<p>在裡面<code translate="No">ViewController</code>類，為視圖添加變量。</p>

	<pre class="line-numbers" data-start="17">
<code class="language-swift" translate="No">class ViewController: UIViewController {
  @IBOutlet weak var videoContainerView: UIView!</code></pre>
	</li>
</ol>

<h4>創建播放服務</h4>

<ol class="bcls-tasklist">
	<li>
	<p>創建一個變量，該變量使用您的帳戶ID和策略密鑰定義Brightcove回放服務。這將在第一次被調用時被初始化。</p>

	<p>如果您不熟悉快速入門，請查看有關以下內容的指南<a href="https://docs.swift.org/swift-book/LanguageGuide/Properties.html">懶惰的存儲屬性</a>。</p>

	<pre class="line-numbers" data-start="20">
<code class="language-swift" translate="No">lazy var playbackService: BCOVPlaybackService = {
  return BCOVPlaybackService(accountId: playbackConfig.accountID, policyKey: playbackConfig.policyKey)
}()</code></pre>
	</li>
</ol>

<h4>創建播放控制器</h4>

<ol class="bcls-tasklist">
	<li>
	<p>創建一個定義Brightcove播放控制器的變量。這將在第一次被調用時創建。</p>

	<ul>
		<li>
		<p>第28-30行：設置代表並打開自動前進和自動播放功能。</p>
		</li>
	</ul>

	<pre class="line-numbers" data-start="24">
<code class="language-swift" translate="No">lazy var playbackController: BCOVPlaybackController? = {
  guard let _playbackController = BCOVPlayerSDKManager.shared().createPlaybackController() else {
    return nil
  }
  _playbackController.delegate = self
  _playbackController.isAutoAdvance = true
  _playbackController.isAutoPlay = true

  return _playbackController
}()</code></pre>
	</li>
</ol>

<h4>定義玩家視圖</h4>

<ol class="bcls-tasklist">
	<li>
	<p>創建一個名為<code translate="No">createTVPlayerView</code>如下：</p>

	<ul>
		<li>38-39行：定義播放器視圖，以便標籤欄面板可以顯示其他視圖控制器。</li>
		<li>第42-44行：創建播放器視圖並將其添加到視頻容器視圖。</li>
		<li>第47行：將播放器視圖與播放控制器相關聯。</li>
		<li>第49行：將播放器視圖添加為主視圖的子視圖。</li>
		<li>第51行：關掉<a href="https://developer.apple.com/documentation/appkit/nsview/1526961-translatesautoresizingmaskintoco">自動調整大小掩碼</a> .</li>
		<li>
		<p>第52-57行：用<a href="https://developer.apple.com/library/archive/documentation/UserExperience/Conceptual/AutolayoutPG/index.html">自動佈局</a>為玩家視圖定義動態約束。</p>
		</li>
	</ul>

	<pre class="line-numbers" data-start="35">
<code class="language-swift" translate="No">lazy var playerView: BCOVTVPlayerView? = {
  // Set yourself as the presenting view controller
  // so that tab bar panels can present other view controllers
  let options = BCOVTVPlayerViewOptions()
  options.presentingViewController = self

  // Create and add to the video container view
  guard let _playerView = BCOVTVPlayerView(options: options) else {
    return nil
  }

  // Link the playback controller to the Player View
  _playerView.playbackController = playbackController

  videoContainerView.addSubview(_playerView)

  _playerView.translatesAutoresizingMaskIntoConstraints = false
  NSLayoutConstraint.activate([
    _playerView.topAnchor.constraint(equalTo: videoContainerView.topAnchor),
    _playerView.rightAnchor.constraint(equalTo: videoContainerView.rightAnchor),
    _playerView.leftAnchor.constraint(equalTo: videoContainerView.leftAnchor),
    _playerView.bottomAnchor.constraint(equalTo: videoContainerView.bottomAnchor)
  ])

  return _playerView
}()</code></pre>
	</li>
</ol>

<h4>創建一個初始化函數</h4>

<ol class="bcls-tasklist">
	<li>創建一個<code translate="No">init</code>功能如下：

	<ul>
		<li>第64行：調用init（）函數的超類實現。</li>
		<li>
		<p>第65行：<strong>可選的：</strong>將您的視頻雲帳戶 ID 發送到分析。僅當您覆蓋<code translate="No">BCOVVideo</code>類或不使用 Brightcove Playback 服務或目錄。</p>

		<aside class="bcls-aside bcls-aside--tip">有關將數據發送到 Video Cloud Analytics 的詳細信息，請參閱<a href="/features/viewing-brightcove-analytics-player-sdks.html">使用 Brightcove 分析</a>指導。</aside>
		</li>
	</ul>

	<pre class="line-numbers" data-start="62">
<code class="language-swift" translate="No">required init?(coder aDecoder: NSCoder)
{
  super.init(coder: aDecoder)
  playbackController?.analytics.account = playbackConfig.accountID;
}</code></pre>
	</li>
</ol>

<h4>加載視圖後的處理</h4>

<ol class="bcls-tasklist">
	<li>
	<p>在裡面<code translate="No">viewDidLoad</code>方法添加以下內容：</p>

	<ul>
		<li>
		<p>第72行：呼叫<code translate="No">requestContentFromPlaybackService</code>函數，我們將在下一步中對其進行定義。</p>
		</li>
	</ul>

	<pre class="line-numbers" data-start="68">
<code class="language-swift" translate="No">override func viewDidLoad() {
  super.viewDidLoad()
  // Do any additional setup after loading the view, typically from a nib.

  requestContentFromPlaybackService()
}</code></pre>
	</li>
</ol>

<h4>從Brightcove庫中請求內容</h4>

<p>為了播放視頻內容，您將向目錄服務請求播放列表</p>

<ol class="bcls-tasklist">
	<li>
	<p>創建一個名為<code translate="No">requestContentFromPlaybackService</code>如下：</p>

	<ul>
		<li>第75-76行：根據給定的視頻ID，從Playback API返回視頻對象。</li>
		<li>第80行：將視頻添加到播放控制器。</li>
		<li>第82行：如果未返回播放列表，則會寫一條錯誤消息。</li>
	</ul>

	<pre class="line-numbers" data-start="75">
<code class="language-swift" translate="No">private func requestContentFromPlaybackService() {
  playbackService.findVideo(withVideoID: playbackConfig.videoID, parameters: nil) { [weak self] (video: BCOVVideo?, jsonResponse: [AnyHashable: Any]?, error: Error?) -&gt; Void in

    if let _video = video {
      //  since "isAutoPlay" is true, setVideos will begin playing the content
      self?.playbackController?.setVideos([_video] as NSArray)
    } else {
      print("ViewController Debug - Error retrieving video: \(error?.localizedDescription ?? "unknown error")")
    }
  }
}</code></pre>
	</li>
</ol>

<h4>擴展播放控制器</h4>

<p>這允許您的應用偵聽和響應視頻播放事件。</p>

<ol class="bcls-tasklist">
	<li>
	<p>擴展視圖控制器以包括Brightcove回放控制器委託，並偵聽回放事件。如果您不熟悉快速入門，請查看有關以下內容的指南<a href="https://docs.swift.org/swift-book/LanguageGuide/Extensions.html">擴展名</a>。</p>

	<pre class="line-numbers" data-start="88">
<code class="language-swift" translate="No">// MARK: - BCOVPlaybackControllerDelegate
extension ViewController: BCOVPlaybackControllerDelegate {

  func playbackController(_ controller: BCOVPlaybackController!, didAdvanceTo session: BCOVPlaybackSession!) {
    NSLog("ViewController Debug - Advanced to new session.")
  }

  func playbackController(_ controller: BCOVPlaybackController!, playbackSession session: BCOVPlaybackSession!, didReceive lifecycleEvent: BCOVPlaybackSessionLifecycleEvent!) {
    NSLog("Event: %@", lifecycleEvent.eventType)
  }
}</code></pre>
	</li>
</ol>

<h4>其餘的部分</h4>

<ol class="bcls-tasklist">
	<li>
	<p>創建函數以處理舊版tvOS的焦點替代。</p>

	<pre class="line-numbers" data-start="100">
<code class="language-swift" translate="No">// MARK: - UIFocusEnvironment overrides
extension ViewController {

  // Focus Environment override for tvOS 9
  override var preferredFocusedView: UIView? {
      return playerView
  }

  // Focus Environment override for tvOS 10+
  override var preferredFocusEnvironments: [UIFocusEnvironment] {
      return (playerView != nil ? [ playerView! ] : [])
  }
}</code></pre>
	</li>
</ol>

<h4 id="viewController">查看代碼</h4>

<p>視圖控制器現已完成。這是完整的代碼：</p>

<pre class="line-numbers" data-start="1">
<code class="language-swift" translate="No">//
//  ViewController.swift
//  Simple-Video-Playback
//
//  Copyright © 2018 Brightcove. All rights reserved.
//

import UIKit
import BrightcovePlayerSDK

fileprivate struct playbackConfig {
  static let policyKey = "<span class="bcls-input">your policy key</span>"
  static let accountID = "<span class="bcls-input">your account id</span>"
  static let videoID = "<span class="bcls-input">your video id</span>"
}

class ViewController: UIViewController {
  @IBOutlet weak var videoContainerView: UIView!

  lazy var playbackService: BCOVPlaybackService = {
      return BCOVPlaybackService(accountId: playbackConfig.accountID, policyKey: playbackConfig.policyKey)
  }()

  lazy var playbackController: BCOVPlaybackController? = {
      guard let _playbackController = BCOVPlayerSDKManager.shared().createPlaybackController() else {
        return nil
      }
      _playbackController.delegate = self
      _playbackController.isAutoAdvance = true
      _playbackController.isAutoPlay = true

      return _playbackController
  }()

  lazy var playerView: BCOVTVPlayerView? = {
    // Set yourself as the presenting view controller
    // so that tab bar panels can present other view controllers
    let options = BCOVTVPlayerViewOptions()
    options.presentingViewController = self

    // Create and add to the video container view
    guard let _playerView = BCOVTVPlayerView(options: options) else {
      return nil
    }

    // Link the playback controller to the Player View
    _playerView.playbackController = playbackController

    videoContainerView.addSubview(_playerView)

    _playerView.translatesAutoresizingMaskIntoConstraints = false
    NSLayoutConstraint.activate([
      _playerView.topAnchor.constraint(equalTo: videoContainerView.topAnchor),
      _playerView.rightAnchor.constraint(equalTo: videoContainerView.rightAnchor),
      _playerView.leftAnchor.constraint(equalTo: videoContainerView.leftAnchor),
      _playerView.bottomAnchor.constraint(equalTo: videoContainerView.bottomAnchor)
    ])

    return _playerView
  }()

  required init?(coder aDecoder: NSCoder)
  {
    super.init(coder: aDecoder)
    playbackController?.analytics.account = playbackConfig.accountID; // Optional
  }

  override func viewDidLoad() {
    super.viewDidLoad()
    // Do any additional setup after loading the view, typically from a nib.

    requestContentFromPlaybackService()
  }

  private func requestContentFromPlaybackService() {
    playbackService.findVideo(withVideoID: playbackConfig.videoID, parameters: nil) { [weak self] (video: BCOVVideo?, jsonResponse: [AnyHashable: Any]?, error: Error?) -&gt; Void in

      if let _video = video {
        //  since "isAutoPlay" is true, setVideos will begin playing the content
        self?.playbackController?.setVideos([_video] as NSArray)
      } else {
        print("ViewController Debug - Error retrieving video: \(error?.localizedDescription ?? "unknown error")")
      }
    }
  }
}

// MARK: - BCOVPlaybackControllerDelegate
extension ViewController: BCOVPlaybackControllerDelegate {

  func playbackController(_ controller: BCOVPlaybackController!, didAdvanceTo session: BCOVPlaybackSession!) {
    NSLog("ViewController Debug - Advanced to new session.")
  }

  func playbackController(_ controller: BCOVPlaybackController!, playbackSession session: BCOVPlaybackSession!, didReceive lifecycleEvent: BCOVPlaybackSessionLifecycleEvent!) {
    NSLog("Event: %@", lifecycleEvent.eventType)
  }
}

// MARK: - UIFocusEnvironment overrides
extension ViewController {

  // Focus Environment override for tvOS 9
  override var preferredFocusedView: UIView? {
    return playerView
  }

  // Focus Environment override for tvOS 10+
  override var preferredFocusEnvironments: [UIFocusEnvironment] {
    return (playerView != nil ? [ playerView! ] : [])
  }
}</code></pre>
</div>
<!--end class="video-cloud-only"--><!--begin class="player-only"-->

<div class="player-only">
<h4>導入本機SDK</h4>

<p>儘管iOS的Brightcove Native Player SDK是用Obj-C編寫的，但是我們可以簡單地將框架模塊導入到我們的Swift項目中。</p>

<ol class="bcls-tasklist">
	<li>
	<p>現有以下<code translate="No">import</code>指令，添加以下內容以導入Brightcove Native Player SDK：</p>

	<pre class="line-numbers" data-start="9">
<code class="language-swift" translate="No">import BrightcovePlayerSDK</code></pre>
	</li>
</ol>

<h4>用您的價值觀定制項目</h4>

<p>添加您的視頻雲帳戶ID的值。</p>

<pre class="line-numbers" data-start="11">
<code class="language-swift" translate="No">fileprivate struct playbackConfig {
    static let accountID = "<span class="bcls-input">your account id</span>"
}</code></pre>

<ol class="bcls-tasklist">
</ol>

<h4>創建一個視圖變量</h4>

<ol class="bcls-tasklist">
	<li>
	<p>在裡面<code translate="No">ViewController</code>類，為視圖添加變量。</p>

	<pre class="line-numbers" data-start="15">
<code class="language-swift" translate="No">class ViewController: UIViewController {
  @IBOutlet weak var videoContainerView: UIView!</code></pre>
	</li>
</ol>

<h4>創建播放控制器</h4>

<ol class="bcls-tasklist">
	<li>
	<p>創建一個定義Brightcove播放控制器的變量。這將在第一次被調用時創建。</p>

	<ul>
		<li>
		<p>第22-24行：設置代表並打開自動前進和自動播放功能。</p>
		</li>
	</ul>

	<pre class="line-numbers" data-start="18">
<code class="language-swift" translate="No">lazy var playbackController: BCOVPlaybackController? = {
  guard let _playbackController = BCOVPlayerSDKManager.shared().createPlaybackController() else {
    return nil
  }
  _playbackController.delegate = self
  _playbackController.isAutoAdvance = true
  _playbackController.isAutoPlay = true

  return _playbackController
}()</code></pre>
	</li>
</ol>

<h4>定義玩家視圖</h4>

<ol class="bcls-tasklist">
	<li>
	<p>創建<code translate="No">playerView</code>如下：</p>

	<ul>
		<li>第32-33行：定義播放器視圖，以便標籤欄面板可以顯示其他視圖控制器。</li>
		<li>第36-38行：創建播放器視圖並將其添加到視頻容器視圖。</li>
		<li>第41行：將播放器視圖與播放控制器相關聯。</li>
		<li>第43行：將播放器視圖添加為主視圖的子視圖。</li>
		<li>第45行：關掉<a href="https://developer.apple.com/documentation/appkit/nsview/1526961-translatesautoresizingmaskintoco">自動調整大小掩碼</a> .</li>
		<li>
		<p>46-51行：用<a href="https://developer.apple.com/library/archive/documentation/UserExperience/Conceptual/AutolayoutPG/index.html">自動佈局</a>為玩家視圖定義動態約束。</p>
		</li>
	</ul>

	<pre class="line-numbers" data-start="29">
<code class="language-swift" translate="No">lazy var playerView: BCOVTVPlayerView? = {
  // Set yourself as the presenting view controller
  // so that tab bar panels can present other view controllers
  let options = BCOVTVPlayerViewOptions()
  options.presentingViewController = self

  // Create and add to the video container view
  guard let _playerView = BCOVTVPlayerView(options: options) else {
    return nil
  }

  // Link the playback controller to the Player View
  _playerView.playbackController = playbackController

  videoContainerView.addSubview(_playerView)

  _playerView.translatesAutoresizingMaskIntoConstraints = false
  NSLayoutConstraint.activate([
    _playerView.topAnchor.constraint(equalTo: videoContainerView.topAnchor),
    _playerView.rightAnchor.constraint(equalTo: videoContainerView.rightAnchor),
    _playerView.leftAnchor.constraint(equalTo: videoContainerView.leftAnchor),
    _playerView.bottomAnchor.constraint(equalTo: videoContainerView.bottomAnchor)
  ])

  return _playerView
}()</code></pre>
	</li>
</ol>

<h4>創建一個初始化函數</h4>

<ol class="bcls-tasklist">
	<li>創建一個<code translate="No">init</code>功能如下：

	<ul>
		<li>第58行：調用init（）函數的超類實現。</li>
		<li>
		<p>第59行：將您的視頻雲帳戶 ID 發送到分析。這會將您的應用程序註冊到 Brightcove。</p>

		<aside class="bcls-aside bcls-aside--tip">有關將數據發送到 Video Cloud Analytics 的詳細信息，請參閱<a href="/features/viewing-brightcove-analytics-player-sdks.html">使用 Brightcove 分析</a>指導。</aside>
		</li>
	</ul>

	<pre class="line-numbers" data-start="56">
<code class="language-swift" translate="No">required init?(coder aDecoder: NSCoder)
{
  super.init(coder: aDecoder)
  playbackController?.analytics.account = playbackConfig.accountID;
}</code></pre>
	</li>
</ol>

<h4>播放影片</h4>

<ol class="bcls-tasklist">
	<li>
	<p>在裡面<code translate="No">viewDidLoad</code>方法添加以下內容：</p>

	<ul>
		<li>67-69行：使用網址路徑創建視頻源數組。</li>
		<li>
		<p>第71行：將視頻陣列添加到控制器的播放隊列中，該隊列設置為自動開始播放。</p>
		</li>
	</ul>

	<pre class="line-numbers" data-start="62">
<code class="language-swift" translate="No">override func viewDidLoad() {
  super.viewDidLoad()
  // Do any additional setup after loading the view, typically from a nib.

  // create an array of videos
  var videoArray = [AnyObject]()
  videoArray = [videoWithURL(url: NSURL(string: "https://learning-services-media.brightcove.com/videos/hls/laughing_gull/laughing_gull.m3u8")!),
                videoWithURL(url: NSURL(string: "https://learning-services-media.brightcove.com/videos/hls/greatblueheron/greatblueheron.m3u8")!)]

  playbackController?.setVideos(videoArray as NSFastEnumeration);
}</code></pre>
	</li>
</ol>

<h4>設置視頻源的傳送方式</h4>

<ol class="bcls-tasklist">
	<li>
	<p>創建一個函數來設置傳遞方式<code translate="No">BCOVSources</code>屬於視頻的影片</p>

	<pre class="line-numbers" data-start="74">
<code class="language-swift" translate="No">func videoWithURL(url: NSURL) -&gt; BCOVVideo {
    // set the delivery method for BCOVSources that belong to a video
    let source:BCOVSource = BCOVSource(url: url as URL?, deliveryMethod: kBCOVSourceDeliveryHLS, properties: nil)
    let video = BCOVVideo.init(source: source, cuePoints: BCOVCuePointCollection.init(array: []), properties: [NSObject:AnyObject]())
    return video!
}</code></pre>
	</li>
</ol>

<h4>擴展播放控制器</h4>

<p>這允許您的應用偵聽和響應視頻播放事件。</p>

<ol class="bcls-tasklist">
	<li>
	<p>擴展視圖控制器以包括Brightcove回放控制器委託，並偵聽回放事件。如果您不熟悉快速入門，請查看有關以下內容的指南<a href="https://docs.swift.org/swift-book/LanguageGuide/Extensions.html">擴展名</a>。</p>

	<pre class="line-numbers" data-start="82">
<code class="language-swift" translate="No">// MARK: - BCOVPlaybackControllerDelegate
extension ViewController: BCOVPlaybackControllerDelegate {

  func playbackController(_ controller: BCOVPlaybackController!, didAdvanceTo session: BCOVPlaybackSession!) {
    NSLog("ViewController Debug - Advanced to new session.")
  }

  func playbackController(_ controller: BCOVPlaybackController!, playbackSession session: BCOVPlaybackSession!, didReceive lifecycleEvent: BCOVPlaybackSessionLifecycleEvent!) {
    NSLog("Event: %@", lifecycleEvent.eventType)
  }
}</code></pre>
	</li>
</ol>

<h4>其餘的部分</h4>

<ol class="bcls-tasklist">
	<li>
	<p>創建函數以處理舊版tvOS的焦點替代。</p>

	<pre class="line-numbers" data-start="94">
<code class="language-swift" translate="No">// MARK: - UIFocusEnvironment overrides
extension ViewController {

  // Focus Environment override for tvOS 9
  override var preferredFocusedView: UIView? {
      return playerView
  }

  // Focus Environment override for tvOS 10+
  override var preferredFocusEnvironments: [UIFocusEnvironment] {
      return (playerView != nil ? [ playerView! ] : [])
  }
}</code></pre>
	</li>
</ol>

<h4 id="viewControllerPerform">查看代碼</h4>

<p>視圖控制器現已完成。這是完整的代碼：</p>

<pre class="line-numbers" data-start="1">
<code class="language-swift" translate="No">//
//  ViewController.swift
//  Simple-Video-Playback
//
//  Copyright © 2018 Brightcove. All rights reserved.
//

import UIKit
import BrightcovePlayerSDK

fileprivate struct playbackConfig {
  static let accountID = "1752604059001"
}

class ViewController: UIViewController {
  @IBOutlet weak var videoContainerView: UIView!

  lazy var playbackController: BCOVPlaybackController? = {
    guard let _playbackController = BCOVPlayerSDKManager.shared().createPlaybackController() else {
      return nil
    }
    _playbackController.delegate = self
    _playbackController.isAutoAdvance = true
    _playbackController.isAutoPlay = true

    return _playbackController
  }()

  lazy var playerView: BCOVTVPlayerView? = {
    // Set yourself as the presenting view controller
    // so that tab bar panels can present other view controllers
    let options = BCOVTVPlayerViewOptions()
    options.presentingViewController = self

    // Create and add to the video container view
    guard let _playerView = BCOVTVPlayerView(options: options) else {
      return nil
    }

    // Link the playback controller to the Player View
    _playerView.playbackController = playbackController

    videoContainerView.addSubview(_playerView)

    _playerView.translatesAutoresizingMaskIntoConstraints = false
    NSLayoutConstraint.activate([
      _playerView.topAnchor.constraint(equalTo: videoContainerView.topAnchor),
      _playerView.rightAnchor.constraint(equalTo: videoContainerView.rightAnchor),
      _playerView.leftAnchor.constraint(equalTo: videoContainerView.leftAnchor),
      _playerView.bottomAnchor.constraint(equalTo: videoContainerView.bottomAnchor)
    ])

    return _playerView
  }()

  required init?(coder aDecoder: NSCoder)
  {
    super.init(coder: aDecoder)
    playbackController?.analytics.account = playbackConfig.accountID;
  }

  override func viewDidLoad() {
    super.viewDidLoad()
    // Do any additional setup after loading the view, typically from a nib.

    // create an array of videos
    var videoArray = [AnyObject]()
    videoArray = [videoWithURL(url: NSURL(string: "https://learning-services-media.brightcove.com/videos/hls/laughing_gull/laughing_gull.m3u8")!),
        videoWithURL(url: NSURL(string: "https://learning-services-media.brightcove.com/videos/hls/greatblueheron/greatblueheron.m3u8")!)]

    playbackController?.setVideos(videoArray as NSFastEnumeration);
  }

  func videoWithURL(url: NSURL) -&gt; BCOVVideo {
    // set the delivery method for BCOVSources that belong to a video
    let source:BCOVSource = BCOVSource(url: url as URL?, deliveryMethod: kBCOVSourceDeliveryHLS, properties: nil)
    let video = BCOVVideo.init(source: source, cuePoints: BCOVCuePointCollection.init(array: []), properties: [NSObject:AnyObject]())
    return video!
  }
}

// MARK: - BCOVPlaybackControllerDelegate
extension ViewController: BCOVPlaybackControllerDelegate {

  func playbackController(_ controller: BCOVPlaybackController!, didAdvanceTo session: BCOVPlaybackSession!) {
    NSLog("ViewController Debug - Advanced to new session.")
  }

  func playbackController(_ controller: BCOVPlaybackController!, playbackSession session: BCOVPlaybackSession!, didReceive lifecycleEvent: BCOVPlaybackSessionLifecycleEvent!) {
    NSLog("Event: %@", lifecycleEvent.eventType)
  }
}

// MARK: - UIFocusEnvironment overrides
extension ViewController {

  // Focus Environment override for tvOS 9
  override var preferredFocusedView: UIView? {
    return playerView
  }

  // Focus Environment override for tvOS 10+
  override var preferredFocusEnvironments: [UIFocusEnvironment] {
    return (playerView != nil ? [ playerView! ] : [])
  }
}</code></pre>
</div>
<!--class="player-only"--></section>
<!--id="Code_the_video_app"-->

<section class="bcls-section" id="&gt;Connect_the_storyboard_view">
<h2>連接情節提要視圖</h2>

<p>連接<code translate="No">Main.storyboard</code>查看與<code translate="No">videoContainer</code>財產。</p>

<ol class="bcls-tasklist">
	<li>
	<p>在Xcode中，打開<code translate="No">Main.storyboard</code>文件。</p>
	</li>
	<li>
	<p>在隨播資料檢視中，展開<strong>查看控制器場景</strong>然後<strong>查看控制器</strong>菜單以顯示<strong>看法</strong>目的。</p>

	<figure class="bcls-figure"><img class="bcls-image" alt="Storyboard view" src="//learning-services-media.brightcove.com/doc-assets/device-sdks/tvos/getting-started/quick-start-swift/storyboard-view.png" />
	<figcaption class="bcls-caption--image">故事板視圖</figcaption>
	</figure>
	</li>
	<li>
	<p>顯示助理編輯器，然後打開<code translate="No">ViewController.swift</code>文件。</p>

	<figure class="bcls-figure"><img class="bcls-image" alt="Assistant editor" src="//learning-services-media.brightcove.com/doc-assets/device-sdks/tvos/getting-started/quick-start-swift/assistant-editor.png" />
	<figcaption class="bcls-caption--image">助理編輯</figcaption>
	</figure>
	</li>
	<li>
	<p>選擇旁邊的空心圓圈<code translate="No">@IBOutlet</code>為了<code translate="No">videoContainerView</code>，並將其拖到<strong>看法</strong>對象來連接這些組件。</p>

	<figure class="bcls-figure"><img class="bcls-image" alt="Connect the view" src="//learning-services-media.brightcove.com/doc-assets/device-sdks/tvos/getting-started/quick-start-swift/connect-view.png" />
	<figcaption class="bcls-caption--image">連接視圖</figcaption>
	</figure>
	</li>
</ol>
</section>

<section class="bcls-section">
<h2 id="Manage_Media_Security">管理媒體安全</h2>

<p>App Transport Security（ATS）可以在您的應用程序和Web服務之間建立安全連接。隨著 Apple 發布 iOS 9 SDK，一項名為<a href="https://developer.apple.com/library/prerelease/ios/technotes/App-Transport-Security-Technote/">應用傳輸安全 (ATS)</a>加入。</p>

<ol class="bcls-tasklist">
	<li>
	<p>以下情況之一將適用於您的應用程序：</p>

	<ul>
		<li>
		<p>默認情況下，適用於iOS的Brightcove Native SDK使用源選擇策略來選擇HTTPS而不是HTTP源，因此您可以在啟用ATS的情況下構建應用程序。</p>

		<p>就是這樣，您已準備好運行您的應用程序。</p>
		</li>
		<br />
		<li>
		<p>如果您使用的是HTTP源或您的應用程序中有其他HTTP調用，則可能會遇到以下錯誤消息：</p>

		<pre class="line-numbers" data-start="1">
<code class="language-swift" translate="No">App Transport Security has blocked a cleartext HTTP (http://) resource load since it is insecure.
Temporary exceptions can be configured via your app's Info.plist file.</code></pre>

		<p>這意味著 ATS 已啟用，但您的系統未配置為滿足 ATS 要求。要解決此問題，請參閱<a href="/ios/framework/working-app-transport-security-ats.html">使用應用傳輸安全 (ATS)</a>文檔。</p>
		</li>
	</ul>
	</li>
</ol>
</section>

<section class="bcls-section">
<h2 id="Run_the_app">運行應用程序</h2>

<div>
<p>該應用程序已準備好在 Apple TV 或 Xcode Simulator 上構建和運行。您應該能夠使用遙控器播放和導航指定的視頻。</p>

<figure class="bcls-figure"><img class="bcls-image--no-border" alt="Apple TV sample" src="//learning-services-media.brightcove.com/doc-assets/device-sdks/tvos/getting-started/quick-start-swift/apple-tv.png" />
<figcaption class="bcls-caption--image">蘋果電視樣本</figcaption>
</figure>
</div>
</section>

<section class="bcls-section">
<h2 id="Run_the_app">Apple TV UI控件</h2>

<p>現在，您準備好了解有關Apple TV播放控件的更多信息，包括用於視頻信息，字幕和音頻的頂部欄視圖。有關更多信息，請參見<a href="/tvos/playback/apple-tv-ui-controls-native-sdk-tvos.html">帶有用於tvOS的Native SDK的Apple TV UI控件</a>文檔。</p>

<p>有關如何構建自己的自定義頂部欄項目視圖的詳細信息，請參見<a href="https://github.com/BrightcoveOS/ios-player-samples/tree/master/Player/AppleTV/swift">Apple TV播放器樣本</a>。</p>
</section>
</article>