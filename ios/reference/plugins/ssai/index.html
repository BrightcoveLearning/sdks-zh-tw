<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8">

	<title>適用於 iOS 的 Brightcove Native Player 參考</title>

	<link rel="stylesheet" href="css/style.css">
	<meta name="viewport" content="initial-scale=1, maximum-scale=1.4">
	<meta name="generator" content="appledoc 2.2.1 (build 1334)">
</head>
<body class="appledoc">
	<header>
		<div class="container" class="hide-in-xcode">
			
			<h1 id="library-title"><a href="index.html">適用於 iOS 的 Brightcove 原生播放器</a></h1>

			<p id="developer-home">
				<a href="index.html">亮灣</a>
			</p>
			
		</div>
	</header>

	<aside>
		<div class="container">
			<nav>
				<ul id="header-buttons" role="toolbar">
					<li><a href="hierarchy.html">等級制度</a></li>
				</ul>
			</nav>
		</div>
	</aside>

	<article>
		<div id="overview-contents" class="container">
			<div id="content">
				<main role="main">
					<h1 class="title">適用於 iOS 的 Brightcove Native Player 參考</h1>

					
					<div class="section section-overview index-overview">
						
						
						<h1>適用於 iOS 版 Brightcove Player SDK 的 SSAI 插件，版本 6.9.0.1697</h1><h1>要求</h1>

<ul>
<li>Xcode 11.0+</li>
<li>弧</li>
</ul>


<h1>支持的平台</h1>

<p>iOS 11.0 及更高版本。</p>

<p>tvOS 11.0 及以上。</p>

<h1>安裝</h1>

<p>Brightcove Player SDK for iOS 的 SSAI 插件提供了兩個安裝包；一個靜態庫框架和一個動態庫框架。</p>

<h2>可可豆</h2>

<p>您可以使用<a href="http://cocoapods.org">可可豆</a>將適用於 Brightcove Player SDK 的 SSAI 插件添加到您的項目中。你可以找到最新的<code>Brightcove-Player-SSAI</code> podspec <a href="https://github.com/brightcove/BrightcoveSpecs/tree/master/Brightcove-Player-SSAI">這裡</a> .</p>

<p>動態框架示例：</p>

<p>```bash源碼&lsquo;<a href="https://github.com/brightcove/BrightcoveSpecs.git" title="">https://github.com/brightcove/BrightcoveSpecs.git'</a></p>

<p>使用_框架！平台：ios，&lsquo; 11.0 &rsquo;</p>

<p>目標&lsquo;我的視頻播放器&rsquo;做豆莢&lsquo; Brightcove-Player-SSAI &rsquo;結束```</p>

<p>靜態框架示例：</p>

<p>```bash源碼&lsquo; https://github.com/brightcove/BrightcoveSpecs.git &rsquo;</p>

<p>使用_框架！平台：ios，11.0'</p>

<p>目標&lsquo;我的視頻播放器&rsquo;做豆莢&lsquo; Brightcove-Player-SSAI-static &rsquo;結束```</p>

<p>更新安裝時，它&rsquo;刷新 BrightcoveSpecs 存儲庫的本地副本是一個好主意，以便您在本地擁有最新的 podspec，就像更新 CococaPods 主存儲庫一樣。</p>

<p>通常，如果您使用<code>豆莢更新</code>在終端中，這將自動發生，或者您可以使用<code>pod repo 更新 Brightcove</code> .（如果您明確將 BrightcoveSpecs 存儲庫添加到 podspecs 存儲庫列表中，則它可能具有不同的名稱。）</p>

<h2>手動的</h2>

<p>將適用於 Brightcove Player SDK 的 SSAI 插件手動添加到您的項目中：</p>

<ol>
<li>安裝最新版本的<a href="https://github.com/brightcove/brightcove-player-sdk-ios/releases">Brightcove 播放器 SDK</a> .</li>
<li>從我們的網站下載 BrightcoveSSAI 插件的最新壓縮版本<a href="https://github.com/brightcove/brightcove-player-sdk-ios-ssai/releases">發布頁面</a> .</li>
<li>添加<code>BrightcoveSSAI.framework</code>到您的項目。</li>
<li>在&ldquo;構建設置&rdquo;應用程序目標的選項卡，確保&ldquo;框架搜索路徑&rdquo;包括框架的路徑。這應該自動完成，除非框架存儲在與您的項目不同的根目錄下。</li>
<li>（僅限動態框架）在&ldquo;一般的&rdquo;應用程序目標的選項卡，添加&lsquo; BrightcoveSSAI.framework &rsquo;到&ldquo;框架、庫、嵌入式內容&rdquo;部分。</li>
<li>（僅限動態框架）在&ldquo;構建階段&rdquo;選項卡，添加一個&ldquo;運行腳本&rdquo;階段與命令<code>猛擊 $ {BUILT_PRODUCTS_DIR} /$ {FRAMEWORKS_FOLDER_PATH} /BrightcoveSSAI.framework/strip-frameworks.sh</code> .查看&ldquo;僅在安裝時運行腳本&rdquo; .這將從構建中刪除不需要的架構，這對於 App Store 提交很重要。</li>
<li>（僅限靜態框架）在&ldquo;構建設置&rdquo;應用程序目標的選項卡，添加<code>-ObjC</code>到&ldquo;其他鏈接器標誌&rdquo;構建設置。</li>
</ol>


<h2>進口</h2>

<p>適用於 iOS 的 Brightcove Player SDK 的 SSAI 插件可以通過幾種不同的方式導入代碼；<code> @import BrightcoveSSAI;</code> , <code> #import &lt;BrightcoveSSAI/BrightcoveSSAI.h&gt;</code>或者<code>#import &lt;BrightcoveSSAI/[特定類].h&gt;</code> .</p>

<h1>快速開始</h1>

<p>BrightcoveSSAI 是一個插件<a href="https://github.com/brightcove/brightcove-player-sdk-ios">適用於 iOS 的 Brightcove Player SDK</a>為 Brightcove 服務器端廣告插入提供支持。</p>

<p>```對象[1] <a href="Classes/BCOVSSAIAdComponentDisplayContainer.html"> BCOVSSAIAdComponentDisplayContainer</a> *displayContainer = [[BCOVSSAIAdComponentDisplayContainer alloc] initWithCompanionSlots:@[]];</p>

<pre><code>BCOVPlayerSDKManager *manager = [BCOVPlayerSDKManager sharedManager];</code></pre>

<p>  [2] 身份證<BCOVPlaybackController> 播放控制器 = [sdkManager createSSAIPlaybackController];</p>

<p>  [3] [playbackController addSessionConsumer:displayContainer];</p>

<p>  [4] [self.videoContainer addSubview:playbackController.view];</p>

<p>  [5] BCOVPlaybackService <em>回放服務 = [[BCOVPlaybackService alloc] initWithAccountId:accoundId policyKey:policyKey]; [playbackService findVideoWithVideoID:videoID 參數：@ { kBCOVPlaybackServiceParamaterKeyAdConfigId: &lt;valid-ad-config-id&gt; }完成：^(BCOVVideo </em>視頻，NSDictionary <em>jsonResponse, NSError </em>錯誤） {</p>

<p>  [6] [playbackController setVideos:@[視頻]]; [播放控制器播放];</p>

<pre><code>}];</code></pre>

<pre><code>總結一下：1.首先創建一個“BCOVSSAIAdComponentDisplayContainer”。此對象將幫助管理隨播廣告位。傳入您擁有的隨播廣告位（如果有）。1.BrightcoveSSAI 向 `BCOVPlaybackManager` 添加了一些類別方法。第一個是`-createSSAIPlaybackControllerWithViewStrategy:`。使用此方法創建您的播放控制器。您通常會為視圖策略傳遞 `nil`。1.為了讓“BCOVSSAIAdComponentDisplayContainer”顯示廣告信息並填充隨播廣告視圖，必須將其添加為會話使用者。1.將播放控制器的視圖添加到您自己的視圖層次結構中的視頻容器。1.從播放服務請求視頻或播放列表。當使用 Unicorn Once-style VMAP URL 時，直接使用 `[BCOVVideo videoWithURL:&lt;unicorn-style-url&gt;]` 創建 BCOVVideo 對象。1.將視頻加載到播放控制器中。使用自定義 VMAP 源 URL ======== 如果您有自定義 VMAP 源 URL 並且不需要使用 `BCOVPlaybackService`，您可以使用您的 URL 手動創建一個 `BCOVVideo`，如下所示：</code></pre>

<p>BCOVVideo *video = [BCOVVideo videoWithURL:[NSURL URLWithString:@ &ldquo; https://sdks.support.brightcove.com/assets/ads/ssai/sample-vmap.xml &rdquo; ]]; [self.playbackController setVideos:@[video]]; ``</p>

<h1>使用 VMAP XML 數據</h1>

<p>如果您有 VMAP XML 數據，您可以手動創建一個<code>BCOV視頻</code>你的數據是這樣的：</p>

<pre><code>// 如果使用 FairPlay DRM，您將需要構建 key_systems 字典 // 否則您可以為屬性值傳遞 `nil`。NSDictionary *properties = @ { @"key_systems": @{ @"com.apple.fps.1_0": @{ @"key_request_url": @"&lt;insert key request URL&gt;", @"certificate_url": @"&lt;insert certificate URL&gt;" } } }; BCOVSource *source = [[BCOVSource alloc] initWithVMAPXMLData:vmapData properties:properties]; BCOVVideo *video = [[BCOVVideo alloc] initWithSource:source cuePoints:nil properties:nil]; [self.playbackController setVideos:@[video]];</code></pre>

<h1>獲取廣告播放信息</h1>

<p>BrightcoveSSAI 通過<code>BCOVPlaybackControllerAdsDelegate</code> .例如，如果您想在廣告期間隱藏您的控件，您可以實施<code>-[BCOVPlaybackControllerAdsDelegate playbackController:playbackSession:didEnterAdSequence:]</code>隱藏它們。</p>

<p>有關如何使用這些委託方法的更多信息，請參閱<a href="https://github.com/brightcove/brightcove-player-sdk-ios">適用於 iOS 的 Brightcove Player SDK</a> .</p>

<h1>尋求</h1>

<p>BrightcoveSSAI 插件提供了一個在實現控件時應該使用的搜索功能。此搜索功能通過會話在會話中公開<code>提供者擴展</code>財產。以下是它的使用方法：</p>

<p>```對象  <br/>
CMTime contentTimeToSeekTo = &lt;calculation-from-scrub-bar&gt;; [self.currentSession.providerExtension ssai_seekToTime:contentTimeToSeekTo completionHandler:^(BOOL 完成) {</p>

<p>  如果（完成）{ [self.currentSession.player play]; }</p>

<p>}]; ``</p>

<p>這<code>完成處理程序</code>將在成功搜索完成時執行。如果先前調用已啟動查找，則不會執行<code>[BCOVSessionProviderExtension ssai_seekToTime:completionHandler:]</code>或者是否正在播放廣告。要測試是否可以進行搜索嘗試，請檢查<code>[BCOVSessionProviderExtension ssai_canSeek]</code>財產。有關這兩種方法的更多信息，請務必閱讀<a href="[https://github.com/brightcove/brightcove-player-sdk-ios-ssai/blob/master/ios/static/BrightcoveSSAI.framework/Headers/BCOVSSAIComponent.h](https://github.com/brightcove/brightcove-player-sdk-ios-ssai/blob/master/ios/static/BrightcoveSSAI.framework/Headers/BCOVSSAIComponent.h)">頭文件</a> .</p>

<h1>無廣告搜索</h1>

<p>BrightcovePlayerSDK 提供了<code>禁用廣告</code>用於在搜索時禁用廣告的 BOOL 屬性，允許應用程序恢復播放，而無需最終用戶查看以前播放的廣告。</p>

<p>在準備尋找，禁用<code>自動播放</code>當設置<code>BCOVPlaybackController</code> .</p>

<p>應將廣告禁用邏輯添加到<code>kBCOVPlaybackSessionLifecycleEventReady</code>的處理者<code>-playbackController:playbackSession:didReceiveLifecycleEvent:</code>你的方法<code>BCOVPlaybackController</code>代表。</p>

<p>```objc - (void)playbackController:(id<BCOVPlaybackController>)控制器播放會話:(id<BCOVPlaybackSession>)session didReceiveLifecycleEvent:(BCOVPlaybackSessionLifecycleEvent *)lifecycleEvent { if ([kBCOVPlaybackSessionLifecycleEventReady isEqualToString:lifecycleEvent.eventType]) { // 禁用廣告。 _playbackController.adsDisabled = YES;</p>

<pre><code>// 在視頻內容中尋找某處。 [session.providerExtension ssai_seekToTime:resumeTime completionHandler:^(BOOL 完成) { // re-enable ads. _playbackController.adsDisabled = NO; // open the shutter. _playbackController.shutterFadeTime = 0.25; _playbackController.shutter = NO; } ];</code></pre>

<p>}```</p>

<p>打電話時<code>ssai_seekToTime:completionHandler:</code>要在特定時間恢復播放，視頻的第一幀可能是可見的，直到搜索完成。為了更清晰的演示，在搜索過程中通過設置臨時覆蓋視頻視圖<code>快門</code> BCOVPlabackController 的屬性為<code>是的</code>打電話之前<code>-setVideos：</code> .搜索完成後，通過設置關閉快門<code>快門</code>財產到<code>不</code> .這<code>快門淡入淡出時間</code>屬性定義快門淡入淡出動畫的持續時間。</p>

<p>```objc self.playbackController = [sdkManager createSSAIPlaybackController];</p>

<p>// 在加載視頻之前激活快門。 self.playbackController.shutterFadeTime = 0.0; self.playbackController.shutter = YES;</p>

<p>// 加載視頻。 ``</p>

<p>請注意，出於性能原因，視頻搜索中內置了小容差。對靠近廣告序列開頭的內容播放頭位置的搜索可能導致對廣告序列開頭的搜索。如果在這種情況下 autoPlay 為 NO，則 AVPlayer 將在廣告序列的第一幀暫停。</p>

<h1>播放器 UI 內置控件</h1>

<p>BrightcovePlayerSDK 提供了一組內置的 UI 控件，可與 SSAI 插件一起用於基本播放和廣告控件。要使用控件，請創建一個<code>BCOVPUIPlayerView</code>，並將其與您的 SSAI 播放控制器相關聯。</p>

<p>首先，在您的類中創建一個 playerView 屬性。</p>

<p><code>objc @property (nonatomic) BCOVPUIPlayerView *playerView;</code></p>

<p>創建<code>BCOVPUIPlayerView</code>實例並保存對對象的引用。</p>

<p><code>objc BCOVPUIBasicControlView *controlView = [BCOVPUIBasicControlView basicControlViewWithVODLayout]; self.playerView = [[BCOVPUIPlayerView alloc] initWithPlaybackController:nil options:nil controlsView:controlView]; // 將 playerView 插入到您自己的視頻視圖中。 [self.videoContainer addSubview:self.playerView];</code></p>

<p>你&rsquo;需要為播放器視圖設置佈局，您可以使用自動佈局或較舊的 Springs &amp; Struts 方法來完成此操作。</p>

<p><strong>彈簧和支柱</strong></p>

<p>設置其框架以匹配您的容器視圖，然後將播放器視圖添加到您的視圖層次結構中的容器視圖中。注意<code>視頻容器</code>是您自己的應用程序中的視圖對象&rsquo; s 佈局。</p>

<p><code>objc self.playerView.frame = self.videoContainer.bounds; self.playerView.autoresizingMask = UIViewAutoresizingFlexibleHeight | UIViewAutoresizingFlexibleWidth;</code></p>

<p><strong>自動佈局</strong></p>

<p><code>objc self.playerView.translatesAutoresizingMaskIntoConstraints = NO; [NSLayoutConstraint activateConstraints:@[ [self.playerView.topAnchor constraintEqualToAnchor:self.videoContainer.topAnchor], [self.playerView.rightAnchor constraintEqualToAnchor:self.videoContainer.rightAnchor], [self.playerView.leftAnchor constraintEqualvideoToAnchor:leftAnchor] , [self.playerView.bottomAnchor constraintEqualToAnchor:self.videoContainer.bottomAnchor], ]];</code>現在創建<code>BCOVPlaybackController</code>，將其分配給您的播放器視圖，然後開始播放視頻。</p>

<p>```objc // 初始化伴隨槽<a href="Classes/BCOVSSAIAdComponentDisplayContainer.html">BCOVSSAIAdComponentDisplayContainer</a> *displayContainer = [[BCOVSSAIAdComponentDisplayContainer alloc] initWithCompanionSlots:@[]];</p>

<p>// 創建播放控制器 BCOVPlayerSDKManager *manager = [BCOVPlayerSDKManager sharedManager]; ID<BCOVPlaybackController> 播放控制器 = [sdkManager createSSAIPlaybackControllerWithViewStrategy:nil];</p>

<p>// 監聽顯示/隨播廣告消息 [playbackController addSessionConsumer:displayContainer];</p>

<p>// 告訴播放器視圖這是我們的播放控制器&rsquo;重新使用 self.playerView.playbackController = 播放控制器；</p>

<p>// 創建並播放您的視頻。對於 Unicorn Once-style VMAP URL，直接創建 BCOVVideo 對象。BCOVPlaybackService <em>回放服務 = [[BCOVPlaybackService alloc] initWithAccountId:accoundId policyKey:policyKey]; [playbackService findVideoWithVideoID:videoID 參數：{ kBCOVPlaybackServiceParamaterKeyAdConfigId: &lt;valid-ad-config-id&gt; }完成：^(BCOVVideo </em>視頻，NSDictionary <em>jsonResponse, NSError </em>錯誤） {</p>

<pre><code>[playbackController setVideos:@[視頻]]; [播放控制器播放]; }];</code></pre>

<pre><code>有關如何使用和自定義 PlayerUI 控件的更多詳細信息，請參閱 BrightcovePlayerSDK 中的自述文件。訪問 VMAP 響應數據 ========================== 如果您想訪問 VMAP 響應數據，您可以訂閱 `kBCOVSSAIVMAPResponseReceivedNotification` 通知。收到後，通知的 userInfo 字典將包含 VMAP 響應作為 NSData。您可以使用 `kBCOVSSAIVMAPResponseReceivedNotificationDataUserInfoKey` 常量從 userInfo 訪問它。由於您可能有多個播放控制器，因此有多個 VMAP 響應，您可以檢查通知的對象，`idplaybackController = notification.object` 來驗證 VMAP 數據用於哪個視頻。此外，當您訂閱通知時，您可以將播放控制器設置為對象，以便僅接收有關該播放控制器的 VMAP 數據通知。例如：```objc [[NSNotificationCenter defaultCenter] addObserver:self selector:@selector(vmapResponseReceived:) name:kBCOVSSAIVMAPResponseReceivedNotification object:self.playbackController];</code></pre>

<p>您還可以通過以下方式訪問 VMAP 響應數據<code>BCOVOUX會話</code>目的：</p>

<pre><code>// Obj-C - (void)playbackController:(id&lt;BCOVPlaybackController&gt;)controller didAdvanceToPlaybackSession:(id&lt;BCOVPlaybackSession&gt;)session { if ([session respondsToSelector:NSSelectorFromString(@"vmapResponseData")]) { NSData *vmapResponseData = [(NSObject *)session valueForKeyPath:@"vmapResponseData"]; NSString *xmlString = [[NSString alloc] initWithData:vmapResponseData encoding:NSUTF8StringEncoding]; NSLog(@"VMAP XML: %@", xmlString); } }</code></pre>

<pre><code>// Swift func 播放控制器(_ 控制器:BCOVPlaybackController!, didAdvanceTo 會話：BCOVPlaybackSession！）{ if (session.responds(to: NSSelectorFromString("vmapResponseData"))) { let vmapResponseData = (session as? NSObject)?.value(forKeyPath: "vmapResponseData") as? Data var xmlString: String? = nil if let vmapResponseData = vmapResponseData { xmlString = String(data: vmapResponseData, encoding: .utf8) } print("VMAP XML: \\(xmlString ?? "")") } }</code></pre>

<h1>已知的問題</h1>

<ul>
<li><p>因為 tvOS 不支持網頁瀏覽、隨播廣告、了解更多以及該平台上的所有廣告點擊都將被忽略。</p></li>
<li><p>您不能將 BrightcoveSSAI 與任何其他 Brightcove 插件一起使用，除了 BrightcoveFairPlay 插件或 BrightcoveIMA 插件（僅適用於前貼片廣告）。</p></li>
<li><p>如果您想將 BrightcoveSSAI 插件與 BrightcoveFairPlay 插件一起使用，則 BrightcoveFairPlay 插件必須是<code>上游會話提供者</code> SSAI 會話提供程序。</p></li>
<li><p>SSAI 插件不支持播放非 SSAI 內容。如果您需要播放非 SSAI 內容，則需要創建另一個不使用 SSAI 插件的播放控制器。</p></li>
</ul>


<h1>支持</h1>

<p>如果您有問題、需要幫助或想提供反饋，請使用<a href="https://supportportal.brightcove.com/s/login/">支持門戶</a>或聯繫您的客戶經理。要接收新 SDK 軟件發布的通知，請訂閱 Brightcove Native Player SDK <a href="https://groups.google.com/g/brightcove-native-player-sdks">谷歌集團</a> .</p>
						
						
					</div>
					

					<div class="index-container">
						

						
						<div class="index-column">
							<h2 class="index-title">類引用</h2>
							<ul>
								
								<li>BCOVSSAIAdComponentDisplayContainer<a href="Classes/BCOVSSAIAdComponentDisplayContainer.html"></a></li>
								
								<li>BCOVSSAICompanionSlot<a href="Classes/BCOVSSAICompanionSlot.html"></a></li>
								
							</ul>
						</div>
						

						
						<div class="index-column">
							
							<h2 class="index-title">協議參考</h2>
							<ul>
								
								<li>BCOVSSAIAdComponentDelegate<a href="Protocols/BCOVSSAIAdComponentDelegate.html"></a></li>
								
							</ul>
							

							

							
							<h2 class="index-title">類別參考</h2>
							<ul>
								
								<li>BCOVPlayerSDKManager(BCOVSSAIAdditions)<a href="Categories/BCOVPlayerSDKManager-BCOVSSAIAdditions.html"></a></li>
								
								<li>BCOVSessionProviderExtension(BCOVSSAIAdditions)<a href="Categories/BCOVSessionProviderExtension-BCOVSSAIAdditions.html"></a></li>
								
								<li>BCOVSource(BCOVSSAIAdditions)<a href="Categories/BCOVSource-BCOVSSAIAdditions.html"></a></li>
								
							</ul>
							
						</div>
						
					</div>

					<footer>
						<div class="footer-copyright">
							
							<p class="copyright">版權&copy; 2021 年光明灣。版權所有。更新：2021-07-08</p>
							
							
							<p class="generator">生成者<a href="http://appledoc.gentlebytes.com">蘋果文檔 2.2.1（內部版本 1334）</a> .</p>
							
						</div>
					</footer>
				</main>
			</div>
		</div>
	</article>

	<script src="js/script.js"></script>
</body>
</html>
