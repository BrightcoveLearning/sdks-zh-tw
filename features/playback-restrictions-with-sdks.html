---
title:“使用本機SDK的播放限制"
description:“在本主題中，您將學習如何將播放限制與 Brightcove Native SDK 結合使用。”
parent: Features 
grandparent: Home
---
 <h1>{{ page.title }}</h1>
<article class="bcls-article">
  <summary>{{ page.description }}</summary>
  
  <!-- <br/>
  <aside class="bcls-aside bcls-aside--tip">This feature is available for a specific set of customers with access to the Limited Availability phase of Brightcove Playback Restrictions.</aside> -->

  <section class="bcls-section">
    <h2 id="Introduction">介紹</h2>
    <p>
      默認情況下，本機SDK與Brightcove Playback API對話，以檢索您的視頻和播放列表內容。一個管理播放權限和限制的新系統位於Playback API的前面，並使用DRM許可證提供播放授權。
    </p>
    <p>您可以使用帶或不帶 DRM 的播放權限，但如果您選擇使用運行時限制，則需要使用 JSON Web 令牌 (JWT)。</p>
    <p>在將動態傳送與受DRM保護的內容或HTTP實時流加密（HLSe）內容一起使用時，許可證密鑰保護可提供更高級別的安全性。可以使用簽名對許可證請求進行身份驗證<a href="https://general.support.brightcove.com/developer/create-json-web-token.html">JSON Web令牌（JWT）</a>。 </p>

    <p>一旦視頻已加載到播放器並選擇了源，則在請求視頻許可時使用令牌。</p>

    <aside class="bcls-aside bcls-aside--information">對於 HLSe 內容，當播放器更改演繹時，由於改進的連接性或在加載第一個片段後，會發出新的許可請求。</aside>

    <p>如果您不熟悉此功能，請參閱<a href="https://apis.support.brightcove.com/playback-restrictions/getting-started/overview-playback-restrictions.html">概述：Brightcove播放限制</a>文檔。</p>
  </section>

  <section class="bcls-section">
    <h2 id="Requirements">要求</h2>
    <p>這是使用“播放限制"所需的要求。</p>
    <!-- <h3>Playback Rights</h3> -->
    <h4>安卓</h4>
    <ul>
      <li>您必須使用 Brightcove Native SDK for Android 版本<strong>6.11.0</strong>或以後</li>
    </ul>
    <h4>的iOS</h4>
    <ul><li>您必須使用 Brightcove Native SDK for iOS 版本<strong>6.7.0</strong>或以後</li>
    </ul>

    <!-- <h3>License Keys Protection</h3>
    <p>To use License Keys Protection, you need the following:</p>
    <ul>
      <li>Player version <strong>6.33.0</strong> or later</li>
      <li>If using DRM, you will need the <a href="https://support.brightcove.com/configuring-brightcove-player-drm#Changelog">DRM plugin</a> version <strong>5.5.0</strong> or later</li>
    </ul> -->

  </section>

  <section class="bcls-section">
    <h2 id="Android_Using_Playback_Rights">安卓：使用播放權限</h2>
    <aside class="bcls-aside bcls-aside--information">筆記：
      <ul>
        <li>使用此實現，使用策略鍵配置的任何內容限制都將被忽略</li>
        <li>在Android平台上，當前僅支持DRM DASH</li>
      </ul>
    </aside>
    <p>
      要發出檢查播放權限和限制的播放 API 請求，請執行以下步驟：
    </p>
    <ol class="bcls-tasklist-restart">
      <li>
        <p>
          從<a href="https://github.com/BrightcoveOS/android-player-samples/tree/master/brightcove-exoplayer/BasicSampleApp/src/main">基本示例應用程序</a> .
        </p>
      </li>
      <li>
        <p>
          默認情況下，適用於Android的Native SDK如果具有策略密鑰，則會向Playback API發出請求。要使用回放權限，請不要隨請求一起發送策略密鑰。
        </p>
        <p>
          創建一個實例<code translate="No">com.brightcove.player.edge.Catalog</code>而不提供策略密鑰。這是一個例子：
        </p>
        <pre>
<code class="language-java" translate="No">Catalog catalog = new Catalog.Builder(eventEmitter, accountId).build();</code></pre>
        <br />
        <p>
          如果您關注的是Brightcove示例應用程序，它將獲得帳戶ID，如下所示：
        </p>
        <pre>
<code class="language-java" translate="No">getString(R.string.account)</code></pre>
        &lt;/br/&gt;
      </li>
      <li>
        <p>
          <strong>可選的</strong>：如果要使用運行時限制，則需要創建一個JWT令牌並將其與目錄請求一起傳遞。
        </p>
        <p>
          要創建您的 JWT 令牌，請按照以下步驟操作<a href="https://apis.support.brightcove.com/playback-restrictions/getting-started/overview-playback-restrictions.html#Runtime_restrictions">運行時限制</a>概述部分：Brightcove播放限製文檔。
        </p>
        <p>
          要通過目錄請求傳遞您的令牌，請參閱<a href="#Using_License_Keys_Protection_Android">使用許可證密鑰保護：安卓</a>部分。
        </p>
      </li>
    </ol>
  </section>

  <section class="bcls-section">
    <h2 id="Android_Using_License_Keys_Protection">安卓：使用許可證密鑰保護</h2>

    <p>適用於 Android 的本機 SDK 當前支持 HLSe 和 Widevine DASH 源的密鑰/許可證保護。您將在 Brightcove 目錄請求中為單個視頻或播放列表提供您的授權令牌。</p>

    <p>
      要發出 Brightcove 目錄請求，請按照下列步驟操作：
    </p>
    <ol class="bcls-tasklist-restart">
      <li>
        <p>
          創建一個<code translate="No">HttpRequestConfig</code>對象並設置Brightcove授權令牌，如下所示：
        </p>
        <pre class="line-numbers"><code class="language-java" translate="No">HttpRequestConfig httpRequestConfig = new HttpRequestConfig.Builder()
  .setBrightcoveAuthorizationToken("<span class="bcls-input">your jwt token</span>")
  .build();
</code></pre>
        <p>
          授權令牌的值將是您的 JSON Web 令牌的值。
        </p>
      </li>
      <li>
        <p>
          創建完<code translate="No">HttpRequestConfig</code>對象，將其傳遞給以下目錄方法之一：
        </p>
        <p>
          對於視頻請求，請使用以下之一：
        </p>
        <pre class="line-numbers"><code class="language-java" translate="No">findVideoByID(String, HttpRequestConfig, VideoListener)
</code></pre>
        <pre class="line-numbers"><code class="language-java" translate="No">findVideoByReferenceID(String, HttpRequestConfig, VideoListener)
</code></pre>
        <p>
          對於播放列表請求，請使用以下之一：
        </p>
        <pre class="line-numbers"><code class="language-java" translate="No">findPlaylistByID(String, HttpRequestConfig, PlaylistListener)
</code></pre>
        <pre class="line-numbers"><code class="language-java" translate="No">findPlaylistByReferenceID(String, HttpRequestConfig, PlaylistListener)
</code></pre>
        <p>
          HLSe 和 Widevine 許可證獲取的令牌使用詳細信息由 SDK 處理。
        </p>
        <aside class="bcls-aside bcls-aside--information">對於播放列表請求，播放列表中的所有視頻必須使用相同的令牌。在將來的版本中，您將能夠為播放列表中的每個視頻分配一個不同的令牌。您將負責維護視頻 ID 和令牌之間的映射。這<code translate="No">conid</code>如定義在<a href="https://general.support.brightcove.com/developer/create-json-web-token.html#Create_a_JSON_Web_Token">JWT 令牌聲明</a>是與令牌關聯的視頻 ID 值。</aside>
      </li>
    </ol>

    <h3>代碼示例</h3>
    <p>
      這是一個示例，顯示了在發出目錄請求時如何傳遞授權令牌：
    </p>
    <pre class="line-numbers"><code class="language-java" translate="No">String myToken = &quot;...&quot;;
HttpRequestConfig httpRequestConfig = new HttpRequestConfig.Builder()
  .setBrightcoveAuthorizationToken(myToken)
  .build();
&hellip;

Catalog catalog = new Catalog(eventEmitter, accountId, policyKey, playbackApiBaseUrl);
catalog.findVideoByReferenceID(videoReferenceId, httpRequestConfig, new VideoListener(){...});
</code></pre>

    <h3>離線播放</h3>
    <p>
      離線目錄<code translate="No">findVideo</code> , <code translate="No">requestPurchaseLicense</code>和<code translate="No">requestRentalLicense</code>方法都需要一個<code translate="No">HttpRequestConfig</code>作為論據。
    </p>
    <aside class="bcls-aside bcls-aside--tip">適用於 Android v6.8.1 或更高版本的 Native SDK 支持離線播放的密鑰/許可證保護。</aside>
    <p>這是一個例子：</p>
    <pre class="line-numbers"><code class="language-java" translate="No">private HttpRequestConfig httpRequestConfig;
private String pasToken = &quot;<span class="bcls-input">your jwt token</span>&quot;;
...
HttpRequestConfig.Builder httpRequestConfigBuilder = new HttpRequestConfig.Builder();
httpRequestConfigBuilder.setBrightcoveAuthorizationToken(pasToken);
httpRequestConfig = httpRequestConfigBuilder.build();
playlist.findPlaylist(catalog, httpRequestConfig, new PlaylistListener() {
    @Override
    public void onPlaylist(Playlist playlist) {
        videoListAdapter.setVideoList(playlist.getVideos());
        onVideoListUpdated(false);
        brightcoveVideoView.addAll(playlist.getVideos());
    }

    @Override
    public void onError(String error) {
        String message = showToast(&quot;Failed to find playlist[%s]: %s&quot;, playlist.displayName, error);
        Log.w(TAG, message);
        onVideoListUpdated(true);
    }
});</code></pre>

    <p>
      有關詳細信息，請參見<a href="https://github.com/BrightcoveOS/android-player-samples/blob/master/brightcove-exoplayer/OfflinePlaybackSampleApp/src/main/java/com/brightcove/player/samples/offlineplayback/MainActivity.java">離線播放示例應用</a>。
    </p>

    <h3>回應</h3>
    <p>
      以下響應與 PAS 相關：
    </p>
    <ul>
      <li>
        200-許可被允許繼續
      </li>
      <li>
        401-不允許繼續交付許可證
      </li>
    </ul>

    <!-- <h3>Limitations</h3>
    <p>
      There is a limitation with the current release:
    </p>
    <ul>
      <li>
        Chromecast is not supported with key/license protection.
      </li>
    </ul> -->
  </section>

  <section class="bcls-section">
    <h2 id="iOS_Using_Playback_Rights">iOS：使用播放權限</h2>
    <aside class="bcls-aside bcls-aside--information">筆記：
      <ul>
        <li>使用此實現，使用策略鍵配置的任何內容限制都將被忽略</li>
      </ul>
    </aside>

    <p>
      要發出檢查播放權限和限制的播放 API 請求，請執行以下步驟：
    </p>
    <ol class="bcls-tasklist-restart">
      <li>
        <p>
          從<a href="https://github.com/BrightcoveOS/ios-player-samples/tree/master/Player/VideoCloudBasicPlayer">基本示例應用程序</a> .
        </p>
      </li>
      <li>
        <p>
          默認情況下，如果iOS的本地SDK具有策略密鑰，則會向Playback API發出請求。要使用回放權限，請不要隨請求一起發送策略密鑰。
        </p>
        <p>
          創建一個實例<code translate="No">BCOVPlaybackService</code>，將策略密鑰設置為<code translate="No">nil</code>。這是一個例子：
        </p>
        <pre>
<code class="language-java" translate="No">let playbackService = BCOVPlaybackService(accountId: kViewControllerAccountID, policyKey: nil)</code></pre>
      </li>
      <li>
        <p>
          <strong>可選的</strong>：如果要使用運行時限制，則需要創建一個JWT令牌並將其與目錄請求一起傳遞。
        </p>
        <p>
          要創建您的 JWT 令牌，請按照以下步驟操作<a href="https://apis.support.brightcove.com/playback-restrictions/getting-started/overview-playback-restrictions.html#Runtime_restrictions">運行時限制</a>概述部分：Brightcove播放限製文檔。
        </p>
        <p>
          要通過目錄請求傳遞您的令牌，請參閱<a href="#Using_License_Keys_Protection_iOS">使用許可證密鑰保護：iOS</a>部分。
        </p>
      </li>
    </ol>
  </section> 

  <section class="bcls-section">
    <h2 id="iOS_Using_License_Keys_Protection">iOS：使用許可證密鑰保護</h2>

    <p>使用密鑰/許可證保護時，您將需要使用允許您傳入授權令牌的播放服務方法。這是使用<code translate="No">authToken</code>範圍。</p>

    <p>
      對於視頻請求，請使用以下之一：
    </p>
    <pre class="line-numbers"><code class="language-objectivec" translate="No">- (void)findVideoWithVideoID:(NSString *)videoID authToken:(NSString *)authToken parameters:(NSDictionary *)parameters completion:(void (^)(BCOVVideo *video, NSDictionary *jsonResponse, NSError *error))completionHandler;
</code></pre>
    <pre class="line-numbers"><code class="language-objectivec" translate="No">- (void)findVideoWithReferenceID:(NSString *)referenceID authToken:(NSString *)authToken parameters:(NSDictionary *)parameters completion:(void (^)(BCOVVideo *video, NSDictionary *jsonResponse, NSError *error))completionHandler;
</code></pre>

    <p>
      對於播放列表請求，請使用以下之一：
    </p>
    <pre class="line-numbers"><code class="language-objectivec" translate="No">- (void)findPlaylistWithPlaylistID:(NSString *)playlistID authToken:(NSString *)authToken parameters:(NSDictionary *)parameters completion:(void (^)(BCOVPlaylist *playlist, NSDictionary *jsonResponse, NSError *error))completionHandler;
</code></pre>
    <pre class="line-numbers"><code class="language-objectivec" translate="No">- (void)findPlaylistWithReferenceID:(NSString *)referenceID authToken:(NSString *)authToken parameters:(NSDictionary *)parameters completion:(void (^)(BCOVPlaylist *playlist, NSDictionary *jsonResponse, NSError *error))completionHandler;
</code></pre>

    <p>
      HLSe 和 FairPlay 許可證獲取的令牌使用詳細信息由 SDK 處理。
    </p>
    <aside class="bcls-aside bcls-aside--information">對於播放列表請求，播放列表中的所有視頻必須使用相同的令牌。在將來的版本中，您將能夠為播放列表中的每個視頻分配一個不同的令牌。您將負責維護視頻 ID 和令牌之間的映射。這<code translate="No">conid</code>如定義在<a href="https://general.support.brightcove.com/developer/create-json-web-token.html#Create_a_JSON_Web_Token">JWT 令牌聲明</a>是與令牌關聯的視頻 ID 值。</aside>

    <p>
      有關詳細信息，請參見<a href="/ios/reference/sdk/index.html#PlaybackAuthorizationService">播放授權服務</a>適用於iOS的Native SDK的“參考"部分。
    </p>

    <h3>離線播放</h3>
    <p>
      如果您將“播放授權服務"與“脫機播放"一起使用，則有一種新的方法來續訂接受授權令牌的FairPlay許可證：
    </p>
    <pre class="line-numbers"><code class="language-objectivec" translate="No">// Request license renewal
    [BCOVOfflineVideoManager.sharedManager renewFairPlayLicense:offlineVideoToken
        video:video // recent video from Playback API or Playback Service class
        authToken: authToken
        Parameters: parameters
        completion:^(BCOVOfflineVideoToken offlineVideoToken, NSError *error)
    {
        // handle errors
    }];
</code></pre>

    <p>
      許可證更新完成後，將使用傳入的相同離線視頻令牌調用完成塊。一個<code translate="No">NSError</code>將指示發生的任何問題（如果沒有錯誤，則為nil）。
    </p>

    <p>
      有關詳細信息，請參見<a href="https://github.com/brightcove/brightcove-player-sdk-ios/blob/master/OfflinePlayback.md#renewing-a-fairplay-license">續訂FairPlay許可證</a>適用於iOS的Native SDK的“參考"部分。
    </p>

    <h3>回應</h3>
    <p>
      以下響應與 PAS 相關：
    </p>
    <ul>
      <li>
        200-許可被允許繼續
      </li>
      <li>
        401-不允許繼續交付許可證
      </li>
    </ul>

  </section>

  <!-- <section class="bcls-section">
    <h2 id="Related_topics">Related topics</h2>
    <ul>
      <li>
        <a href="/playback-rights/getting-started/overview-epa.html">Overview: Playback Rights Management Service</a>
      </li>
      <li>
        <a href="/playback-rights/getting-started/implementing-epa.html">Implementing Playback Rights Management Service</a>
      </li>
      <li>
        <a href="/playback-rights/guides/using-epa-with-bcp.html">Using Playback Rights with Brightcove Player</a>
      </li>
      <li>
        <a href="/playback-authorization/guides/stream-concurrency.html">Implementing Stream Concurrency</a>
      </li>
    </ul>
  </section> -->

</article>