---
title: '為適用於 Android 的 Native SDK 創建插件' 
description:在本主題中，您將學習如何為適用於 Android 的 Native SDK 創建插件。
parent: Framework 
grandparent: Android Development
---
 <h1>{{ page.title }}</h1>
<article class="bcls-article">
  <summary>{{ page.description }}</summary>

<section class="bcls-section">
<h2 id="Overview">概述</h2>

<p>在較高的層次上，插件通過偵聽和發出事件與播放器集成。插件可以偵聽來自播放器和其他插件的事件。插件可以為播放器和其他插件發出事件。</p>

<p>此內容以及示例代碼位於<a href="https://github.com/BrightcoveOS/android-plugin-guide">https://github.com/BrightcoveOS/android-plugin-guide</a></p>
</section>

<section class="bcls-section">
<h2 id="Plugin_architecture">插件架構</h2>

<div class="BCL-concept">
<p>實例化後，插件應在SDK中註冊。註冊一個插件應該發出一個<code translate="No">REGISTER_PLUGIN</code>事件與<code translate="No">PLUGIN_NAME</code>財產。例如：</p>

<pre class="line-numbers">
  <code class="language-java" translate="No">Map&lt;String, Object&gt; properties = new HashMap&lt;String, Object&gt;();
  properties.put(Event.PLUGIN_NAME, "my custom plugin");
  eventEmitter.emit(EventType.REGISTER_PLUGIN, properties);</code></pre>

<p>視頻播放通常經過一個標準的生命週期事件流：</p>

<figure class="bcls-figure"><img class="bcls-image" alt="Plugin event flow" src="/assets/images/android/framework/plugin-event-flow.png" />
<figcaption class="bcls-caption--image">插件事件流</figcaption>
</figure>
</div>
</section>

<section class="bcls-section">
<h2 id="Event_details">活動詳情</h2>

<div class="BCL-concept">
<p>插件可以偵聽啟動某些操作的事件，以更改播放器的默認行為。這些事件包括：</p>

<ol>
	<li><code translate="No">WILL_CHANGE_VIDEO</code></li>
	<li><code translate="No">SET_VIDEO</code></li>
	<li><code translate="No">SET_SOURCE</code></li>
	<li><code translate="No">PLAY</code></li>
	<li><code translate="No">PAUSE</code></li>
	<li><code translate="No">SEEK_TO</code></li>
	<li><code translate="No">STOP</code></li>
</ol>

<p>可以通過阻止默認偵聽器接收事件和/或停止將事件傳播到非默認偵聽器來更改默認行為。阻止默認偵聽器接收事件的方法是調用<code translate="No">preventDefault()</code>方法。可以通過調用<code translate="No">stopPropagation()</code>方法。要是<code translate="No">preventDefault()</code>調用後，將通知其餘的非默認偵聽器。要是<code translate="No">stopPropagation()</code>調用後，仍將通知默認偵聽器，但其他非默認偵聽器將被跳過。插件還可以使用這些方法來暫停正常事件流並插入其他行為，例如初始化插件。插件可以通過再次發出原始事件來恢復事件流。</p>

<p>插件還可以偵聽事件，這些事件表明操作已完成。這些事件通常由分析插件使用。活動包括：</p>

<ol>
	<li><code translate="No">DID_CHANGE_LIST</code></li>
	<li><code translate="No">DID_SELECT_SOURCE</code></li>
	<li><code translate="No">DID_PAUSE</code></li>
	<li><code translate="No">DID_PLAY</code></li>
	<li><code translate="No">DID_SEEK_TO</code></li>
	<li><code translate="No">DID_SET_SOURCE</code></li>
	<li><code translate="No">DID_STOP</code></li>
	<li><code translate="No">PROGRESS</code></li>
	<li><code translate="No">COMPLETED</code></li>
</ol>
</div>
</section>

<section class="bcls-section">
<h2 id="Interrupt_playback">中斷播放</h2>

<div class="BCL-concept">
<p>想要中斷視頻內容播放的插件應使用<code translate="No">WILL_INTERRUPT_CONTENT</code>和<code translate="No">WILL_RESUME_CONTENT</code>。這些事件通常由廣告插件使用。一個插件應該發出<code translate="No">WILL_INTERRUPT_CONTENT</code>請求暫停播放（如果當前正在播放），並請求使視頻視圖不可見。一個插件應該發出<code translate="No">WILL_RESUME_CONTENT</code>要求再次使視頻視圖可見。這<code translate="No">WILL_RESUME_CONTENT</code>事件應包括<code translate="No">ORIGINAL_EVENT</code>將在視頻視圖可見後發出的屬性。這<code translate="No">ORIGINAL_EVENT</code>應該是一個<code translate="No">PLAY</code>恢復播放的事件，一個<code translate="No">CUE_POINT</code>繼續提示點處理的事件，或<code translate="No">COMPLETED</code>事件完成播放。一種<code translate="No">SKIP_CUE_POINTS</code>屬性應添加到<code translate="No">ORIGINAL_EVENT</code>以防止遞歸提示點處理。</p>
</div>
</section>

<section class="bcls-section">
<h2 id="Cue_points">提示點</h2>

<div class="BCL-concept">
<p>許多插件都想听<code translate="No">CUE_POINT</code>事件。提示點分為三種類型，<code translate="No">BEFORE</code> , <code translate="No">POINT_IN_TIME</code>， 和<code translate="No">AFTER</code> . <code translate="No">BEFORE</code>提示點在播放開始之前發出。<code translate="No">POINT_IN_TIME</code>當播放到達提示點位置時發出提示點。<code translate="No">AFTER</code>播放完成後會立即發出提示點。插件應使用<code translate="No">WILL_INTERRUPT_CONTENT</code>和<code translate="No">WILL_RESUME_CONTENT</code>事件，以在處理提示點事件時中斷並恢復內容播放。對於提示點之前和之後，事件將包括<code translate="No">ORIGINAL_EVENT</code>屬性，具有<code translate="No">PLAY</code>事件或<code translate="No">COMPLETED</code>事件。提示點事件還包括<code translate="No">CUE_POINTS</code>屬性和一批提示點。<code translate="No">START_TIME</code>和<code translate="No">END_TIME</code>屬性定義提示點時間範圍。</p>
</div>
</section>

<section class="bcls-section">
<h2 id="Sample_directory">示例目錄</h2>

<div class="BCL-concept">
<p>這<a href="https://github.com/BrightcoveOS/android-plugin-guide/tree/master/sample">示例目錄</a>包括一個基於 Android Studio 的項目，其中包含兩個模塊：</p>

<ul>
	<li><strong>示例插件</strong> - 一個示例插件，可用作編寫新插件的基礎。</li>
	<li><strong>示例插件應用程序</strong> - 展示瞭如何將插件整合到 Brightcove 視頻應用程序中，並可用於測試 SamplePlugin 或新插件。</li>
</ul>
</div>
</section>

<section class="bcls-section">
<h2 id="Implementation_steps">實施步驟</h2>

<div class="BCL-concept">
<p>編寫插件的步驟包括：</p>

<ol>
	<li>將樣本插件複製到新的存儲庫。</li>
	<li>更改包和類的名稱。</li>
	<li>更新<code translate="No">TAG</code>初始化程序。</li>
	<li>編輯<code translate="No">@Emits</code>和<code translate="No">@ListensFor</code>註釋以反映插件發出和監聽的事件。</li>
	<li>根據需要修改構造函數。</li>
	<li>更換或卸下<code translate="No">videoView</code>相關邏輯（如有必要）。</li>
	<li>調整<code translate="No">initializeListeners()</code>通過根據需要添加和/或減去事件偵聽器。</li>
	<li>編譯並分發您的插件<strong>.aar</strong> Android Studio的文件。</li>
	<!--                <li>Compile and distribute your plugin as a .jar file for Eclipse and/or an .aar file for Android Studio.</li>-->
</ol>
</div>
</section>
</article>