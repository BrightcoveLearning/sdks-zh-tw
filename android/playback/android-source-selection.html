---
title: '安卓：源選擇' 
description:在本主題中，您將了解適用於 Android 的 Brightcove Native Player SDK 如何在播放視頻時使用默認源選擇過程。
parent: Playback 
grandparent: Android Development
---
 <h1>{{ page.title }}</h1>
<article class="bcls-article">
  <summary>{{ page.description }}</summary>

<section class="bcls-section">
<h2 id="Introduction">介紹</h2>

<p>當您從 Brightcove 目錄中檢索視頻時，SDK 必須決定播放哪個源。這是在<a href="/android/reference/javadoc/com/brightcove/player/controller/DefaultSourceSelectionController.html">默認源選擇控制器</a>和<a href="/android/reference/javadoc/com/brightcove/player/controller/ExoPlayerSourceSelectionController.html">ExoPlayerSourceSelectionController</a>成分。</p>
</section>

<section class="bcls-section">
<h2 id="Default_selection_process">默認選擇過程</h2>

<p>適用於 Android 的 Brightcove Player SDK 使用默認的源選擇過程。為簡化起見，我們將重點介紹 SDK 對 Brightcove Playback API 和 Google 的 ExoPlayer 的支持。</p>

<p>默認選擇過程定義如下：</p>

<ol class="bcls-tasklist">
	<li>
	<p>對於適用於 Android 6.4+ 的 Brightcove Native SDK，如果可用，則會選擇所有源類型的 HTTPS 傳輸。</p>

	<p>這倆<a href="/android/reference/javadoc/com/brightcove/player/controller/DefaultSourceSelectionController.html">DefaultSourceSelectionController</a>和<a href="/android/reference/javadoc/com/brightcove/player/controller/ExoPlayerSourceSelectionController.html">ExoPlayerSourceSelectionController</a>嘗試選擇HTTPS版本的<code translate="No">deliveryType</code>已選擇。如果不存在HTTPS源，則選擇控制器將選擇第一個可用的HTTPS。</p>

	<aside class="bcls-aside bcls-aside--information">如果您的視頻同時具有用於 WebVTT 字幕/副標題的 HTTP 和 HTTPS 源，則適用於 Android 的本機 SDK 可能不會返回 HTTPS 版本。Brightcove 已意識到這種情況，並將在未來版本中進行修復。</aside>
	</li>
	<li>這<a href="/android/reference/javadoc/com/brightcove/player/view/BrightcoveExoPlayerVideoView.html">BrightcoveExoPlayerVideoView</a>尋找第一個具有<code translate="No">deliveryType</code>的<strong>MPEG-DASH</strong>，以及既不是<strong>骨灰盒：hbbtv</strong>也不<strong>骨灰盒：dvb</strong> .SDK 不支持使用這些 DASH 配置文件中的任何一個進行播放，因此它們將從源中過濾掉。</li>
	<li>如果未找到上述內容，則源選擇會使用<code translate="No">deliveryType</code>的<strong>HLS</strong>。</li>
	<li>如果找不到這樣的來源，則會使用<code translate="No">deliveryType</code>的<strong>MP4</strong>以及最接近256 kBps的比特率。</li>
</ol>

<p>找到源之後，實現將繼續如下：</p>

<ol class="bcls-tasklist">
	<li>如果找到，將發出選定的信號源並響應<strong>SELECT_SOURCE</strong>事件。</li>
	<li>默認情況下，<a href="/android/reference/javadoc/com/brightcove/player/controller/VideoPlaybackController.html"> VideoPlaybackController</a>處理<strong>SELECT_SOURCE</strong>響應，通過發出一個<strong>SET_SOURCE</strong>事件。</li>
	<li>這<a href="/android/reference/javadoc/com/brightcove/player/display/VideoDisplayComponent.html">視頻顯示組件</a>或子類處理<strong>SET_SOURCE</strong>通過將 URL 加載到底層播放器（ExoPlayer 或 MediaPlayer）來觸發事件。</li>
	<li>播放開始時，底層播放器負責使用 HLS 和 DASH 內容調整比特率。使用 HLS，底層播放器從主清單中列出的第一個比特率開始。</li>
</ol>

<p>使用默認轉碼設置時，第一個 HLS 源應該是指向所有單個源（再現）的主 m3u8 播放列表。</p>
</section>

<section class="bcls-section">
<h2 id="Setting_HLS_sources">設置 HLS 源</h2>

<p>可以在應用程序級別自定義源選擇，以在調用SDK的默認源選擇策略之前過濾掉所有不需要的傳遞類型。為此，您需要修改從 Playback API 的 JSON 響應設置到 Video 對像中的源集合。</p>

<p>此示例僅使用 HLS 源：</p>

<pre class="line-numbers">
<code class="language-java" translate="No">catalog.findVideoByReferenceID(videoReferenceId, new com.brightcove.player.edge.VideoListener() {
	@Override
	public void onVideo(Video video) {
	 sourceSelectionFilter(DeliveryType.HLS, video);
	 brightcoveVideoView.add(video);
	 brightcoveVideoView.start();
	}
});</code></pre>

<p>和<code translate="No">sourceSelectionFilter()</code>方法將如下所示：</p>

<pre class="line-numbers">
<code class="language-java" translate="No">public static void sourceSelectionFilter(@NonNull DeliveryType deliveryTypeFilter, @NonNull Video video) {
 if (video.getSourceCollections().containsKey(deliveryTypeFilter)) {
   // Only remove the other delivery types if the desired type is in our Source collections
   for (DeliveryType deliveryType : DeliveryType.values()) {
     if (!deliveryType.equals(deliveryTypeFilter)) {
            video.getSourceCollections().remove(deliveryType);
     }
   }
 }
}</code></pre>
</section>
</article>