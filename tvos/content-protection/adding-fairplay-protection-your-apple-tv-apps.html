---
title: '為您的 Apple TV 應用程序添加 FairPlay 保護' 
description:在本主題中，您將學習如何將 FairPlay 內容保護添加到使用 Brightcove Native SDK for tvOS 的 Apple TV 應用程序。
parent: Content Protection 
grandparent: tvOS Development
---
 <h1>{{ page.title }}</h1>
<article class="bcls-article">
  <summary>{{ page.description }}</summary>

<section class="bcls-section">
<h2 id="Overview">概述</h2>

<p>適用於 tvOS 的 Native SDK 支持使用 HLS 和 FairPlay Streaming 的數字版權管理 (DRM) 保護。當您的帳戶啟用 DRM 並配置為動態交付時，您的視頻將在您攝取時自動打包為 DRM。</p>

<p>由於對受FairPlay保護的視頻的支持已集成到Brightcove本機SDK的核心框架中，因此您無需加載應用程序證書。有關詳細信息，請參見<a href="/features/content-security-drm-native-player-sdks.html">帶有本地播放器SDK的內容安全性（DRM）</a>文檔。</p>

<aside class="bcls-aside bcls-aside--information">本示例將受 FairPlay 保護的內容與 Dynamic Delivery 結合使用。如果您使用的是舊版攝取，請參閱<a href="https://github.com/BrightcoveOS/ios-player-samples/tree/master/FairPlay/BasicFairPlayPlayer/swift">基本公平遊戲</a>樣本。</aside>
</section>

<section class="bcls-section">
<h2 id="Code_sample">程式碼範例</h2>

<p>要將 FairPlay 內容保護添加到您的 Apple TV 應用程序，請按照以下步驟操作：</p>

<ol class="bcls-tasklist">
	<li>從<a href="https://github.com/BrightcoveOS/ios-player-samples/tree/master/Player/AppleTV/swift">基本的蘋果電視</a>示例應用程序。</li>
	<li>將FairPlay許可代碼添加到您的應用中。這可以在<a href="https://github.com/BrightcoveOS/ios-player-samples/tree/master/FairPlay/BasicFairPlayPlayer/swift">基本公平遊戲</a>樣本。</li>
</ol>

<p>您的代碼<strong>視圖控制器.swift</strong>文件應與此類似：</p>

<pre class="line-numbers">
<code class="language-swift" translate="No">//
//  ViewController.swift
//  Fairplay-Video-Playback
//
//  Copyright © 2019 Brightcove. All rights reserved.
//

import UIKit
import BrightcovePlayerSDK

// This example is for content using Dynamic Delivery. Because of this, you do NOT need to specify your FairPlay Application ID or the FairPlay Publisher ID.
fileprivate struct playbackConfig {
    static let policyKey = "<span class="bcls-input">your policy key</span>"
    static let accountID = "<span class="bcls-input">your account ID</span>"
    static let videoID = "<span class="bcls-input">your video ID</span>"
}

class ViewController: UIViewController {
    @IBOutlet weak var videoContainerView: UIView!

    var playbackController: BCOVPlaybackController = BCOVPlayerSDKManager.shared().createPlaybackController()
    var fairPlayAuthProxy: BCOVFPSBrightcoveAuthProxy?

    lazy var playerView: BCOVTVPlayerView? = {
        // Set ourself as the presenting view controller
        // so that tab bar panels can present other view controllers
        let options = BCOVTVPlayerViewOptions()
        options.presentingViewController = self

        // Create and add to the video container view
        guard let _playerView = BCOVTVPlayerView(options: options) else {
            return nil
        }

        // Link the playback controller to the Player View
        _playerView.playbackController = playbackController

        videoContainerView.addSubview(_playerView)

        _playerView.translatesAutoresizingMaskIntoConstraints = false
        NSLayoutConstraint.activate([
            _playerView.topAnchor.constraint(equalTo: videoContainerView.topAnchor),
            _playerView.rightAnchor.constraint(equalTo: videoContainerView.rightAnchor),
            _playerView.leftAnchor.constraint(equalTo: videoContainerView.leftAnchor),
            _playerView.bottomAnchor.constraint(equalTo: videoContainerView.bottomAnchor)
            ])

        return _playerView
    }()

    lazy var playbackService: BCOVPlaybackService = {
        return BCOVPlaybackService(accountId: playbackConfig.accountID, policyKey: playbackConfig.policyKey)
    }()

    required init?(coder aDecoder: NSCoder)
    {
        super.init(coder: aDecoder)
    }

    override func viewDidLoad() {
        super.viewDidLoad()
        // Do any additional setup after loading the view, typically from a nib.

        // With Dynamic Delivery, you don't need to load
        // an application certificate. The FairPlay session will load an
        // application certificate for you if needed.
        // You can just load and play your FairPlay videos.

        // With Dynamic Delivery, you can pass nil for the publisherId and applicationId
        self.fairPlayAuthProxy = BCOVFPSBrightcoveAuthProxy(publisherId: nil,
                                                            applicationId: nil)

        let sdkManager = BCOVPlayerSDKManager.sharedManager()

        // Create chain of session providers
        let psp = sdkManager?.createBasicSessionProvider(with:nil)
        let fps = sdkManager?.createFairPlaySessionProvider(withApplicationCertificate:nil,
                                                            authorizationProxy:self.fairPlayAuthProxy!,
                                                            upstreamSessionProvider:psp)

        createSampleTabBarItemView()

        // Create the playback controller
        playbackController = (sdkManager?.createPlaybackController(with:fps, viewStrategy:nil))!
        // Configure the playback controller
        playbackController.isAutoAdvance = false
        playbackController.isAutoPlay = true
        playbackController.delegate = self

        // Link the playback controller to the Player View
        playerView?.playbackController = playbackController

        requestContentFromPlaybackService()
    }

    private func createSampleTabBarItemView() {

        guard let playerView = playerView, var topTabBarItemViews = playerView.settingsView.topTabBarItemViews else {
            return
        }

        let sampleTabBarItemView = SampleTabBarItemView(size: CGSize.init(width: 620, height: 200), playerView: playerView)

        // Insert our new tab bar item view at the end of the top tab bar
        topTabBarItemViews.append(sampleTabBarItemView)
        playerView.settingsView.topTabBarItemViews = topTabBarItemViews
    }

    private func requestContentFromPlaybackService() {
        playbackService.findVideo(withVideoID: playbackConfig.videoID, parameters: nil) { [weak self] (video: BCOVVideo?, jsonResponse: [AnyHashable: Any]?, error: Error?) -&gt; Void in

            if let _video = video {
                //  since "isAutoPlay" is true, setVideos will begin playing the content
                self?.playbackController.setVideos([_video] as NSArray)
            } else {
                print("ViewController Debug - Error retrieving video: \(error?.localizedDescription ?? "unknown error")")
            }

        }
    }
}

// MARK: - UIFocusEnvironment overrides
extension ViewController {

    // Focus Environment override for tvOS 9
    override var preferredFocusedView: UIView? {
        return playerView
    }

    // Focus Environment override for tvOS 10+
    override var preferredFocusEnvironments: [UIFocusEnvironment] {
        return (playerView != nil ? [ playerView! ] : [])
    }

}

// MARK: - BCOVPlaybackControllerDelegate
extension ViewController: BCOVPlaybackControllerDelegate {

    func playbackController(_ controller: BCOVPlaybackController!, didAdvanceTo session: BCOVPlaybackSession!) {
        NSLog("ViewController Debug - Advanced to new session.")
    }

    func playbackController(_ controller: BCOVPlaybackController!, playbackSession session: BCOVPlaybackSession!, didReceive lifecycleEvent: BCOVPlaybackSessionLifecycleEvent!) {
        NSLog("Event: %@", lifecycleEvent.eventType)
    }

}</code></pre>
</section>
</article>