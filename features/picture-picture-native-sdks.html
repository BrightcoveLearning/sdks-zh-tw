---
title:帶有本機SDK描述的畫中畫：在本主題中，您將了解如何使用 Brightcove Native Player SDK 在您的應用程序中實現畫中畫模式。
parent: Features 
grandparent: Home
---
 <h1>{{ page.title }}</h1>
<article class="bcls-article">
  <summary>{{ page.description }}</summary>

<section class="bcls-section">
<h2 id="Overview">概述</h2>

<p>畫中畫（PIP）模式允許用戶在其設備上執行多任務。使用此功能，您可以創建應用程序，在用戶執行其他任務時，將一個小的視頻播放窗口固定在屏幕的一角。</p>

<figure class="bcls-figure"><img class="bcls-image--no-border" width="600" alt="Picture in picture mode" src="/assets/images/getting-started/pip/android-steps.png" />
<figcaption class="bcls-caption--image">畫中畫模式</figcaption>
</figure>
</section>

<section class="bcls-section">
<h2 id="Features">特徵</h2>

<p>Brightcove Native SDK 提供的畫中畫功能支持以下功能：</p>

<ul>
	<li>當用戶通過單擊控制欄中的 PIP 圖標進入畫中畫模式時，開發人員可以通過編程方式進入畫中畫模式。</li>
	<li>用戶可以在屏幕的角落周圍拖動 PIP 窗口，將其放置在最方便的位置。</li>
	<li>用戶可以在 PIP 窗口中暫停和播放視頻，或完全刪除它。用戶還可以將視頻最大化返回應用內體驗。</li>
	<li>PIP模式可在應用程序，設備背景和其他應用程序之上運行。</li>
</ul>
</section>

<section class="bcls-section">
<h2 id="Supported_versions">支持的版本</h2>

<p>以下版本支持畫中畫模式：</p>

<h3>設備操作系統版本</h3>

<ul>
	<li><strong>安卓：</strong>奧利奧8.0+（API級別26+）</li>
	<li><strong>iOS：</strong>10.0+</li>
</ul>

<h3>本機SDK版本</h3>

<ul>
	<li><strong>安卓：</strong>適用於Android版本6.1.0+的Brightcove本機SDK</li>
	<li><strong>iOS：</strong>適用於iOS版本6.4.4+的Brightcove本機SDK</li>
</ul>
</section>

<section class="bcls-section">
<h2 id="Android_implementation">Android實施</h2>

<p>以下主題將幫助您開始使用畫中畫功能：</p>

<ul>
	<li><a href="#Using_BrightcovePlayer">使用 BrightcovePlayer</a></li>
	<li><a href="#Using_a_regular_Activity">使用常規活動</a></li>
	<li><a href="#Customizing_picture_in_picture">自定義畫中畫</a></li>
</ul>

<p>有關更多詳細信息，請參見Android的<a href="https://developer.android.com/guide/topics/ui/picture-in-picture.html">畫中畫支持指南</a>。</p>

<h3 id="Using_BrightcovePlayer">使用 BrightcovePlayer</h3>

<p>開始使用畫中畫的最簡單方法是讓您的活動擴展<code translate="No">BrightcovePlayer</code> .為此，請按照下列步驟操作：</p>

<ol class="bcls-tasklist">
	<li>在你的<strong>styles.xml</strong>文件，通過添加以下代碼啟用“畫中畫"按鈕：

	<pre class="line-numbers">
<code class="language-xml" translate="No">&lt;style name="BrightcoveControlBar" parent="BrightcoveControlBarDefault"&gt;
    &lt;item name="brightcove_picture_in_picture"&gt;true&lt;/item&gt;
&lt;/style&gt;</code></pre>
	</li>
	<li>在你的<strong>AndroidManifest.xml</strong>文件，<a href="https://developer.android.com/guide/topics/ui/picture-in-picture.html#declaring">聲明畫中畫支持</a>為此活動添加以下內容：
	<pre class="line-numbers">
<code class="language-xml" translate="No">&lt;activity android:name="VideoActivity"
  android:resizeableActivity="true"
<span class="bcls-highlight">  android:supportsPictureInPicture="true"
  android:configChanges=
      "screenSize|smallestScreenSize|screenLayout|orientation"</span>
  ...
</code></pre>

	<p>這是重要的一步。如果您未聲明，則當用戶按下Brightcove Media Controller中的畫中畫按鈕時，<code translate="No">IllegalStateException</code>將被拋出：</p>

	<pre>
<code class="language-java" translate="No">java.lang.IllegalStateException: enterPictureInPictureMode: Current activity does not support picture in picture</code></pre>
	</li>
</ol>

<p>當進入畫中畫模式時，活動本身會調整大小，保留畫中畫窗口中的所有活動組件。為了避免這種情況並提供更簡單的實現，Brightcove 視頻視圖將自動進入全屏以匹配父佈局的寬度和高度，僅顯示畫中畫窗口中的視頻。退出此模式後，Brightcove視頻視圖將返回其原始狀態。</p>

<p>如果您不希望在應用程序中使用畫中畫，則可以通過在您的應用中添加以下代碼來禁用畫中畫按鈕<strong>styles.xml</strong>文件：</p>

<pre class="line-numbers">
<code class="language-xml" translate="No">&lt;style name="BrightcoveControlBar" parent="BrightcoveControlBarDefault"&gt;
    &lt;item name="brightcove_picture_in_picture"&gt;false&lt;/item&gt;
&lt;/style&gt;</code></pre>

<h3 id="Using_a_regular_Activity">使用常規活動</h3>

<p>如果您使用的活動不會延長<code translate="No">BrightcovePlayer</code>，除瞭如前一節所述聲明對畫中畫的支持外，您還需要執行一些額外的步驟：</p>

<ol class="bcls-tasklist__restart">
	<li>打開<strong>MainActivity.java</strong>文件。</li>
	<li>在裡面<code translate="No">onCreate</code>活動的方法，請向Brightcove註冊活動<code translate="No">PictureInPictureManager</code>：
	<pre>
<code class="language-java" translate="No">PictureInPictureManager.getInstance().registerActivity(Activity, BrightcoveVideoView)</code></pre>
	</li>
	<li>在裡面<code translate="No">onDestroy</code>方法，註銷活動：
	<pre>
<code class="language-java" translate="No">PictureInPictureManager.getInstance().unregisterActivity(Activity)</code></pre>
	</li>
	<li>覆蓋<code translate="No">onPictureInPictureModeChanged</code>活動方法，並調用<code translate="No">onPictureInPictureModeChanged()</code>方法如下圖所示：
	<pre class="line-numbers">
<code class="language-java" translate="No">@Override
  public void onPictureInPictureModeChanged (boolean isInPictureInPictureMode, Configuration newConfig) {
     super.onPictureInPictureModeChanged(isInPictureInPictureMode, newConfig);
     PictureInPictureManager.getInstance().onPictureInPictureModeChanged(isInPictureInPictureMode, newConfig);
  }</code></pre>
	</li>
	<li>最後，覆蓋<code translate="No">onUserLeaveHint()</code>活動方法，並調用<code translate="No">onUserLeaveHint()</code>如下所示：
	<pre class="line-numbers">
<code class="language-java" translate="No">@Override
  public void onUserLeaveHint () {
     super.onUserLeaveHint();
     PictureInPictureManager.getInstance().onUserLeaveHint();
  }</code></pre>
	</li>
</ol>

<p>完成這些步驟後，“畫中畫"按鈕將自動出現在Brightcove Media Controller中。您還可以通過以下方式以編程方式觸發畫中畫：</p>

<pre>
<code class="language-java" translate="No">PictureInPictureManager.getInstance().enterPictureInPictureMode()</code></pre>

<aside class="bcls-aside bcls-aside--information">注意調用這個方法會拋出一個<code translate="No">PictureInPictureManagerException</code>如果 Activity 尚未註冊。</aside>

<h3 id="Customizing_picture_in_picture">自定義畫中畫</h3>

<p>您可以自定義畫中畫窗口的行為和外觀<code translate="No">PictureInPictureManager</code> .例如，您可以更改窗口的寬高比或為視頻啟用/禁用字幕。</p>

<p>Android Oreo原生提供了三個可以自定義的參數：</p>

<ul>
	<li><a href="https://developer.android.com/reference/android/app/PictureInPictureParams.Builder.html#setAspectRatio(android.util.Rational)">長寬比</a>

	<pre>
<code class="language-java" translate="No">setAspectRatio(Rational)</code></pre>
	</li>
	<li><a href="https://developer.android.com/reference/android/app/PictureInPictureParams.Builder.html#setSourceRectHint(android.graphics.Rect)">源邊界提示</a>
	<pre>
<code class="language-java" translate="No">setSourceRectHint(Rect)</code></pre>
	</li>
	<li><a href="https://developer.android.com/reference/android/app/PictureInPictureParams.Builder.html#setActions(java.util.List%3Candroid.app.RemoteAction%3E)">遠程操作列表</a>
	<pre>
<code class="language-java" translate="No">setUserActions(List&lt;RemoteAction&gt;)</code></pre>
	</li>
</ul>

<h4>用戶操作</h4>

<p>Brightcove添加了一個<code translate="No">RemoteAction</code>默認情況下，它處理<code translate="No">Play/Pause</code>視頻事件並設置它們各自的圖標。這意味著默認<code translate="No">RemoteAction</code>將添加到您使用以下設置的遠程操作列表中：</p>

<pre>
<code class="language-java" translate="No">setUserActions</code></pre>

<p>請記住，您只能設置有限數量的操作。為了得到<a href="https://developer.android.com/reference/android/app/Activity.html#getMaxNumPictureInPictureActions()">最大操作數</a>，調用如下：</p>

<pre>
<code class="language-java" translate="No">Activity.getMaxNumPictureInPictureActions()</code></pre>

<h4>隱藏式字幕</h4>

<p>在畫中畫模式下播放視頻時，您可以啟用/禁用隱藏式字幕，方法是在<code translate="No">inPictureInPictureManager</code> .</p>

<pre>
<code class="language-java" translate="No">setClosedCaptionsEnabled(boolean)</code></pre>

<p>默認情況下，隱藏式字幕在手機中處於禁用狀態，而在平板電腦中處於啟用狀態。要在畫中畫模式下播放時減小隱藏式字幕的大小，請調用以下命令以設置介於<code translate="No">0</code>和<code translate="No">1.0f</code> .</p>

<pre>
<code class="language-java" translate="No">setClosedCaptionsReductionScaleFactor(float)</code></pre>

<p>默認情況下，圖片模式下圖片的隱藏式字幕尺寸為<code translate="No">0.5f</code>或原始大小的50％。最後，在活動時以圖片模式輸入圖片<code translate="No">onUserLeaveHint()</code>被稱為，將以下內容設置為<code translate="No">true</code>：</p>

<pre>
<code class="language-java" translate="No">setOnUserLeaveEnable(boolean)</code></pre>

<h4>參數</h4>

<p>為了檢索圖片參數中的當前圖片，可以調用以下命令：</p>

<pre>
<code class="language-java" translate="No">PictureInPicture.getBrightcovePictureInPictureParams()</code></pre>

<p>此調用返回<code translate="No">BrightcovePictureInPictureParams</code>對象，它具有前面討論過的所有參數的 getter。</p>
</section>

<section class="bcls-section">
<h2 id="iOS_implementation">iOS實施</h2>

<p>要開始使用畫中畫，請添加<code translate="No">showPictureInPictureButton</code>到<code translate="No">BCOVPUIPlayerViewOptions</code> .當設置為 true 時，畫中畫按鈕將添加到支持設備上的播放器控件中。</p>
<p>畫中畫是其中之一<a href="https://www.apple.com/ios/ios-14/features/">iOS 14的新功能</a>。</p>

<p>有關更多詳細信息，請參見以下內容：</p>

<ul>
	<li>這<a href="https://github.com/brightcove/brightcove-player-sdk-ios#PIP">畫中畫</a>供 iOS 參考的 Brightcove Native SDK 部分</li>
	<li>蘋果<a href="https://developer.apple.com/documentation/avkit/adopting_picture_in_picture_in_a_custom_player">在自定義播放器中採用畫中畫</a>文檔</li>
</ul>

<p>有關代碼示例，請參見<a href="https://github.com/BrightcoveOS/ios-player-samples/tree/master/Player/VideoCloudBasicPlayer">基本視頻播放應用</a>。</p>
</section>

<section class="bcls-section">
<h2 id="Limitations">局限性</h2>

<h3>安卓</h3>

<ul>
	<li>畫中畫功能僅適用於裝有Android Oreo或更高版本的設備</li>
	<li>目前不支持Android TV</li>
	<li>不支持帶廣告的視頻</li>
	<li>不支持360視頻</li>
</ul>

<h3>的iOS</h3>

<ul>
	<li>不支持帶廣告的視頻</li>
	<li>不支持360視頻</li>
</ul>
</section>

<section class="bcls-section">
<h2 id="Known_issues">已知的問題</h2>

<h3>安卓</h3>

<ul>
	<li>我們發現，在搭載 Android 8.0 的 Pixel C 中，以畫中畫模式播放的受 Widevine 保護的視頻會變成透明或黑色。該問題在使用 Android 8.1 的同一設備中無法重現。</li>
</ul>
</section>
</article>
